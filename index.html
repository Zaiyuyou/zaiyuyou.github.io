<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="true" > 
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet">
<link href="https://cdn.staticfile.org/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>在与有</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">

  <meta property="og:type" content="website">
<meta property="og:title" content="在与有">
<meta property="og:url" content="http://zaiyuyou.github.io/index.html">
<meta property="og:site_name" content="在与有">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Zaiyuyou">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  
  
    
<div id="banner" class=" is_home ">
  <img src="/img/titlebar.png" itemprop="image">
  <div id="banner-dim"></div>
</div>
 
   
  <div id="main-grid" class="  ">
    <div id="nav" class=" is_home "  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>在与有 </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">主页</a>
    
      <a class="main-nav-link" href="/archives">归档</a>
    
      <a class="main-nav-link" href="/about">关于</a>
    
      <a class="main-nav-link" href="/tags">标签</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="light-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M438.5-829.913v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-829.913Zm0 747.826v-48q0-17.452 11.963-29.476 11.964-12.024 29.326-12.024 17.363 0 29.537 12.024t12.174 29.476v48q0 17.452-11.963 29.476-11.964 12.024-29.326 12.024-17.363 0-29.537-12.024T438.5-82.087ZM877.913-438.5h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537t29.476-12.174h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T877.913-438.5Zm-747.826 0h-48q-17.452 0-29.476-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T82.087-521.5h48q17.452 0 29.476 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T130.087-438.5Zm660.174-290.87-34.239 32q-12.913 12.674-29.565 12.174-16.653-.5-29.327-13.174-12.674-12.673-12.554-28.826.12-16.152 12.794-28.826l33-35q12.913-12.674 30.454-12.674t30.163 12.847q12.709 12.846 12.328 30.826-.38 17.98-13.054 30.653ZM262.63-203.978l-32 34q-12.913 12.674-30.454 12.674t-30.163-12.847q-12.709-12.846-12.328-30.826.38-17.98 13.054-30.653l33.239-31q12.913-12.674 29.565-12.174 16.653.5 29.327 13.174 12.674 12.673 12.554 28.826-.12 16.152-12.794 28.826Zm466.74 33.239-32-33.239q-12.674-12.913-12.174-29.565.5-16.653 13.174-29.327 12.673-12.674 28.826-13.054 16.152-.38 28.826 12.294l35 33q12.674 12.913 12.674 30.454t-12.847 30.163q-12.846 12.709-30.826 12.328-17.98-.38-30.653-13.054ZM203.978-697.37l-34-33q-12.674-12.913-13.174-29.945-.5-17.033 12.174-29.707t31.326-13.293q18.653-.62 31.326 13.054l32 34.239q11.674 12.913 11.174 29.565-.5 16.653-13.174 29.327-12.673 12.674-28.826 12.554-16.152-.12-28.826-12.794ZM480-240q-100 0-170-70t-70-170q0-100 70-170t170-70q100 0 170 70t70 170q0 100-70 170t-170 70Zm-.247-82q65.703 0 111.475-46.272Q637-414.544 637-480.247t-45.525-111.228Q545.95-637 480.247-637t-111.475 45.525Q323-545.95 323-480.247t45.525 111.975Q414.05-322 479.753-322ZM481-481Z"/></svg></span>
      <span class="dark-mode-icon"><svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M480.239-116.413q-152.63 0-258.228-105.478Q116.413-327.37 116.413-480q0-130.935 77.739-227.435t206.304-125.043q43.022-9.631 63.87 10.869t3.478 62.805q-8.891 22.043-14.315 44.463-5.424 22.42-5.424 46.689 0 91.694 64.326 155.879 64.325 64.186 156.218 64.186 24.369 0 46.978-4.946 22.609-4.945 44.413-14.076 42.826-17.369 62.967 1.142 20.142 18.511 10.511 61.054Q807.174-280 712.63-198.206q-94.543 81.793-232.391 81.793Zm0-95q79.783 0 143.337-40.217 63.554-40.218 95.793-108.283-15.608 4.044-31.097 5.326-15.49 1.283-31.859.805-123.706-4.066-210.777-90.539-87.071-86.473-91.614-212.092-.24-16.369.923-31.978 1.164-15.609 5.446-30.978-67.826 32.478-108.282 96.152Q211.652-559.543 211.652-480q0 111.929 78.329 190.258 78.329 78.329 190.258 78.329ZM466.13-465.891Z"/></svg></span>
    </a>
    
    <div id="nav-menu-btn" class="nav-icon">
      <svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 -960 960 960" width="20"><path d="M177.37-252.282q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Zm0-186.218q-17.453 0-29.477-11.963-12.024-11.964-12.024-29.326 0-17.363 12.024-29.537T177.37-521.5h605.26q17.453 0 29.477 11.963 12.024 11.964 12.024 29.326 0 17.363-12.024 29.537T782.63-438.5H177.37Zm0-186.217q-17.453 0-29.477-11.964-12.024-11.963-12.024-29.326t12.024-29.537q12.024-12.174 29.477-12.174h605.26q17.453 0 29.477 11.964 12.024 11.963 12.024 29.326t-12.024 29.537q-12.024 12.174-29.477 12.174H177.37Z"/></svg>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">主页</a>
    
      <a class="nav-dropdown-link" href="/archives">归档</a>
    
      <a class="nav-dropdown-link" href="/about">关于</a>
    
      <a class="nav-dropdown-link" href="/tags">标签</a>
    
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
        <image src=/img/head.png></image>
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">Zaiyuyou </div>
      <div class="dot"></div>
      <div class="subtitle">随心遂意-常习常喜-拾慧时惠 </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/Zaiyuyou/" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      


  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">分类</h3>
      <div class="category-box">
            <a class="category-link" href="/categories/%E7%BC%96%E7%A8%8B/">
                编程
                <div class="category-count">12</div>
            </a>
        
            <a class="category-link" href="/categories/Linux/">
                Linux
                <div class="category-count">5</div>
            </a>
        <div class="children"><div class="category-box">
            <a class="category-link" href="/categories/Linux/%E7%BC%96%E7%A8%8B/">
                编程
                <div class="category-count">1</div>
            </a>
        </div></div>
            <a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/">
                前端
                <div class="category-count">1</div>
            </a>
        <div class="children"><div class="category-box">
            <a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/java/">
                java
                <div class="category-count">1</div>
            </a>
        <div class="children"><div class="category-box">
            <a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/java/%E7%BC%96%E7%A8%8B/">
                编程
                <div class="category-count">1</div>
            </a>
        </div></div></div></div></div>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">标签</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/C%E8%AF%AD%E8%A8%80/" rel="tag">C语言</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%85%B3%E9%94%AE%E5%AD%97/" rel="tag">关键字</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%86%85%E5%AD%98/" rel="tag">内存</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" rel="tag">字符串</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%8C%87%E9%92%88/" rel="tag">指针</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" rel="tag">文件操作</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E7%B4%A2%E5%BC%95/" rel="tag">索引</a></li></ul>
    </div>
  </div>


    
  </div>
</sidebar>
    </div>
    <div id="content-body">
      
   


<article id="post-Welcome" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2025/03/04/Welcome/">欢迎！</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-03-04T03:11:43.507Z" itemprop="datePublished">2025-03-04</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
    未分类 
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            299 词 
          </div>
        </div>
        
      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p>欢来到我的博客，在我认真学习的大学三年里，我发现无论是用平板手写笔记，还是onenote笔记或者是单纯的云笔记，都无法满足我的记录需要，比如笔记间的跳转引用什么的（就像写程序一样！），后来我发现Markdown虽然可以支持跳转，但是既然我都要填地址了，干啥不填网址呢？而且还可以随时随地访问查看，温故而知新~</p>
<p>于是我决定用Hexo来搭建一个博客，并且用Github来托管，这样我就可以随时随地访问我的笔记&#x2F;博客了，而且还可以用Markdown来写博客并且到处跳转，简直完美！</p>
<p>另外也算圆了一个小时候的目标吧~拥有一个看起来酷酷的网站。✅</p>
<p>希望你也能从这里找到需要的知识，时间就是生命，开源万岁！</p>

        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2025-2-24" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2025/02/23/2025-2-24/">来点前端</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2025-02-23T16:00:00.000Z" itemprop="datePublished">2025-02-24</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>><a class="meta-cate-link" href="/categories/%E5%89%8D%E7%AB%AF/java/">java</a>><a class="meta-cate-link" href="/categories/%E5%89%8D%E7%AB%AF/java/%E7%BC%96%E7%A8%8B/">编程</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            36k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="来点前后端"><a href="#来点前后端" class="headerlink" title="来点前后端"></a>来点前后端</h1><p>ok，最近要搞前端项目练手，来点spring boot</p>
<h2 id="1-0-后端：Spring-Boot-这是什么？"><a href="#1-0-后端：Spring-Boot-这是什么？" class="headerlink" title="1.0.后端：Spring Boot?这是什么？"></a>1.0.后端：Spring Boot?这是什么？</h2><p>找到<a target="_blank" rel="noopener" href="https://springdoc.cn/spring-boot/getting-started.html#getting-started.installing">springboot的教程</a>，开始部署开发环境。</p>
<p>不过我觉得直接从IDEA开局貌似更好？</p>
<p>直接在github上找到Spring的开源项目[<a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-framework">点我去看看</a>]<br>简单瞅一眼，发现有这个框架在IDEA中部署开发的教程，<a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-framework/blob/main/import-into-idea.md">让我看看</a>。</p>
<blockquote>
<p>Steps:<br>Within your locally cloned spring-framework working directory:</p>
<p>Precompile spring-oxm with .&#x2F;gradlew :spring-oxm:compileTestJava<br>Import into IntelliJ (File -&gt; New -&gt; Project from Existing Sources -&gt; Navigate to directory -&gt; Select build.gradle)<br>When prompted exclude the spring-aspects module (or after the import via File-&gt; Project Structure -&gt; Modules)</p>
</blockquote>
<p>OK，gradle的部署方式，那在IDEA中从已有的远程项目中创建。</p>
<p>欸？好像启动不了一个可运行的示例，我再找找…<strong>原来是可以使用<a target="_blank" rel="noopener" href="https://start.spring.io/">Spring Initializr</a>直接创建一个项目啊</strong>，看来之前安装的Spring-framework项目如果要启动要使用集成测试，属于是新手误入Boss房了。</p>
<p>好，<a target="_blank" rel="noopener" href="https://start.spring.io/">Spring Initializr</a>生成出来的项目小很多，使用IDEA启动并完成构建之后，我们就有了一个简易的Spring Boot项目了。</p>
<h2 id="1-1-将SpringBoot连接到我的Mysql"><a href="#1-1-将SpringBoot连接到我的Mysql" class="headerlink" title="1.1.将SpringBoot连接到我的Mysql"></a>1.1.将SpringBoot连接到我的Mysql</h2><h3 id="Step1-数据库准备"><a href="#Step1-数据库准备" class="headerlink" title="Step1.数据库准备"></a>Step1.数据库准备</h3><p>Mysql部分：使用Navicat轻松创建表格定义数据类型，这里我创建了一个test数据库后在库中定义一个user表方便我们后续的类定义以及其他的功能。</p>
<p>**user表格(用户)**：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span> (</span><br><span class="line">    userid <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,<span class="comment">-- 用户ID，自增主键</span></span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,<span class="comment">-- 用户名，唯一且不能为空</span></span><br><span class="line">    password <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">-- 密码，不能为空</span></span><br><span class="line">    gender ENUM(<span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>, <span class="string">&#x27;other&#x27;</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>, <span class="comment">-- 性别，枚举类型：male、female、other</span></span><br><span class="line">    birthdate <span class="type">DATE</span>,<span class="comment">-- 出生日期，格式为YYYY-MM-DD</span></span><br><span class="line">    address <span class="type">VARCHAR</span>(<span class="number">255</span>),<span class="comment">-- 家庭住址，字符串类型</span></span><br><span class="line">		peopleid <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">-- 身份证号，字符串类型，不能为空</span></span><br><span class="line">		peoplename <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,<span class="comment">-- 真实姓名，字符串类型，不能为空</span></span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>, <span class="comment">-- 用户创建时间，默认为当前时间</span></span><br><span class="line">    updated_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="comment">-- 用户信息更新时间，默认为当前时间，更新时自动更新</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>**medical_records表格(病历)**：<br>这个表一个外键，使其与users表中的userid相关联</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> medical_records (</span><br><span class="line">    record_id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,  <span class="comment">-- 主键</span></span><br><span class="line">    userid <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,                        <span class="comment">-- 关联到用户表的userid，注意这里使用INT类型</span></span><br><span class="line">    diagnosis_date <span class="type">DATE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,               <span class="comment">-- 诊断日期</span></span><br><span class="line">    doctor <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,               <span class="comment">-- 医生姓名</span></span><br><span class="line">    diagnosis TEXT <span class="keyword">NOT</span> <span class="keyword">NULL</span>,                    <span class="comment">-- 诊断结果</span></span><br><span class="line">    remark TEXT,                                <span class="comment">-- 备注信息</span></span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (userid) <span class="keyword">REFERENCES</span> <span class="keyword">user</span>(userid) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在IDEA中，点击窗口右侧的数据库图标，在里面添加我们的数据库，笔者这里用的Mysql，其他厂商的数据库你在下拉列表里找到就行了。<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-IDEAdatabase0.png?raw=true" alt="Alt text"><br>点击后填写我们的数据库信息，数据库方面不是本文重点，这里不过多笔墨了。</p>
<h3 id="Step2-配置项目依赖并重新构建"><a href="#Step2-配置项目依赖并重新构建" class="headerlink" title="Step2.配置项目依赖并重新构建"></a>Step2.配置项目依赖并重新构建</h3><p>SpringBoot部分：我使用的是gradle构建，因此我在<code>build.gradle</code>中配置必要的依赖项</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">  id <span class="string">&#x27;java&#x27;</span></span><br><span class="line">  id <span class="string">&#x27;org.springframework.boot&#x27;</span> version <span class="string">&#x27;3.4.3&#x27;</span></span><br><span class="line">  id <span class="string">&#x27;io.spring.dependency-management&#x27;</span> version <span class="string">&#x27;1.1.7&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">group</span> = <span class="string">&#x27;com.example&#x27;</span></span><br><span class="line">version = <span class="string">&#x27;0.0.1-SNAPSHOT&#x27;</span></span><br><span class="line"></span><br><span class="line">java &#123;</span><br><span class="line">  toolchain &#123;</span><br><span class="line">    languageVersion = JavaLanguageVersion.of(<span class="number">23</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">repositories</span> &#123;</span><br><span class="line">  mavenCentral()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">  implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter&#x27;</span></span><br><span class="line">  implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-actuator&#x27;</span></span><br><span class="line">  testImplementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-test&#x27;</span></span><br><span class="line">  testRuntimeOnly <span class="string">&#x27;org.junit.platform:junit-platform-launcher&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// MySQL Connector/J</span></span><br><span class="line">  runtimeOnly <span class="string">&#x27;mysql:mysql-connector-java:8.0.33&#x27;</span> <span class="comment">// 根据具体项目调整版本号</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Spring Data JPA</span></span><br><span class="line">  implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-data-jpa&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Spring Web Starter 依赖</span></span><br><span class="line">  implementation <span class="string">&#x27;org.springframework.boot:spring-boot-starter-web&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//Junit，后面测试连通性用到的依赖</span></span><br><span class="line">  testImplementation(<span class="string">&#x27;org.springframework.boot:spring-boot-starter-test&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">exclude</span> <span class="keyword">group</span>: <span class="string">&#x27;org.junit.vintage&#x27;</span>, module: <span class="string">&#x27;junit-vintage-engine&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 确保包含AssertJ</span></span><br><span class="line">  testImplementation <span class="string">&#x27;org.assertj:assertj-core:3.24.2&#x27;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tasks.named(<span class="string">&#x27;test&#x27;</span>) &#123;</span><br><span class="line">  useJUnitPlatform()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果飘红，就按照IDEA的引导引入对应的依赖库就行了。</p>
<p><code>mysql-connector</code>的版本和Mysql版本有关，我的Mysql版本是8.0,所以这里使用8.0的Connector，具体的Connector版本和Mysql版本的对照可以到Mysql官网查看</p>
<p><strong>添加完成依赖之后，运行<code>build.gradle</code>完成构建</strong></p>
<h3 id="Step3-配置数据库连接"><a href="#Step3-配置数据库连接" class="headerlink" title="Step3.配置数据库连接"></a>Step3.配置数据库连接</h3><p><strong>在<code>application.properties</code>中添加数据库连接配置</strong>，当然，如果我们的spring版本比较旧，可能是<code>application.yml</code>之类的文件，这里我贴出我的<code>application.properties</code>，<code>yml格式</code>的文件<strong>不支持</strong>直接粘贴进去。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/your_database_name?useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="comment">## 自己改your_database_name</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">your_username</span></span><br><span class="line"><span class="comment">## 自己改your_username</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">your_password</span></span><br><span class="line"><span class="comment">## 自己改your_password</span></span><br><span class="line"><span class="attr">spring.jpa.hibernate.ddl-auto</span>=<span class="string">update</span></span><br></pre></td></tr></table></figure>


<h3 id="Step4-创建用户实体类"><a href="#Step4-创建用户实体类" class="headerlink" title="Step4.创建用户实体类"></a>Step4.创建用户实体类</h3><p>根据我们刚刚新建的User表创建JPA实体类<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-IDEAdatabase1.png?raw=true" alt="Alt text"></p>
<p>然后，进入<code>User</code>类，IDEA生成的JPA代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.*;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.annotations.ColumnDefault;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;userid&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;username&quot;, nullable = false, length = 50)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;password&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Lob</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;gender&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;birthdate&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> LocalDate birthdate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;address&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;pepoleid&quot;, nullable = false, length = 20)</span></span><br><span class="line">    <span class="keyword">private</span> String pepoleid;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;pepolename&quot;, nullable = false, length = 20)</span></span><br><span class="line">    <span class="keyword">private</span> String pepolename;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ColumnDefault(&quot;CURRENT_TIMESTAMP&quot;)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;created_at&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Instant createdAt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ColumnDefault(&quot;CURRENT_TIMESTAMP&quot;)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;updated_at&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Instant updatedAt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getGender</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setGender</span><span class="params">(String gender)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> LocalDate <span class="title function_">getBirthdate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> birthdate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBirthdate</span><span class="params">(LocalDate birthdate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.birthdate = birthdate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPepoleid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> pepoleid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPepoleid</span><span class="params">(String pepoleid)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pepoleid = (String) pepoleid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPepolename</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> pepolename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPepolename</span><span class="params">(String pepolename)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pepolename = pepolename;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Instant <span class="title function_">getCreatedAt</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createdAt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCreatedAt</span><span class="params">(Instant createdAt)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.createdAt = createdAt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Instant <span class="title function_">getUpdatedAt</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> updatedAt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUpdatedAt</span><span class="params">(Instant updatedAt)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.updatedAt = updatedAt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>然后你会看到<code>@Table(name = &quot;user&quot;)</code>这一行中有警告，根据IDEA的提示给他重新分配数据源到我们刚刚创建的<code>user</code>数据库中</strong><br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-IDEA1.png?raw=true" alt="Alt text"></p>
<p>完成之后你<code>Ctrl+鼠标左键</code>点击这个<code>&quot;user&quot;</code>应该是能触发你IDEA弹出数据库的弹窗的，这样就对了。</p>
<p>另外，你会发现在<code>User</code>类在<code>com.example.demo</code>中，为了方便管理，我们在<code>com.example.demo</code>下创建一个<code>entity</code>包，并将<code>User</code>类移动到这个包中。</p>
<p>做完这些之后的项目结构：<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-IDEA0.png?raw=true" alt="Alt text"></p>
<p>对病历表实体进行同样的操作，将<code>MedicalRecord</code>类移动到<code>com.example.demo.entity</code>包中。<br><code>MedicalRecord</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jakarta.persistence.*;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.annotations.ColumnDefault;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.annotations.OnDelete;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.annotations.OnDeleteAction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.Instant;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table(name = &quot;medical_records&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MedicalRecord</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;record_id&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ManyToOne(fetch = FetchType.LAZY, optional = false)</span></span><br><span class="line">    <span class="meta">@OnDelete(action = OnDeleteAction.CASCADE)</span></span><br><span class="line">    <span class="meta">@JoinColumn(name = &quot;userid&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> User userid;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;diagnosis_date&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> LocalDate diagnosisDate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(name = &quot;doctor&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String doctor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Lob</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;diagnosis&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String diagnosis;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Lob</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;remark&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String remark;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ColumnDefault(&quot;CURRENT_TIMESTAMP&quot;)</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;created_at&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Instant createdAt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUserid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserid</span><span class="params">(User userid)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userid = userid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> LocalDate <span class="title function_">getDiagnosisDate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> diagnosisDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDiagnosisDate</span><span class="params">(LocalDate diagnosisDate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.diagnosisDate = diagnosisDate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDoctor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> doctor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDoctor</span><span class="params">(String doctor)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.doctor = doctor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getDiagnosis</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> diagnosis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDiagnosis</span><span class="params">(String diagnosis)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.diagnosis = diagnosis;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getRemark</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> remark;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRemark</span><span class="params">(String remark)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.remark = remark;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Instant <span class="title function_">getCreatedAt</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createdAt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCreatedAt</span><span class="params">(Instant createdAt)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.createdAt = createdAt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Step5-编写数据访问层Repository"><a href="#Step5-编写数据访问层Repository" class="headerlink" title="Step5.编写数据访问层Repository"></a>Step5.编写数据访问层Repository</h3><p>在项目中<code>src/main/java/com.example.demo/</code>下创建一个<code>repository</code>包，并在其中创建一个<code>UserRepository</code><strong>接口</strong>，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserRepository</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;User, Integer&gt; &#123;</span><br><span class="line">    User <span class="title function_">findByUsername</span><span class="params">(String username)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>做完之后如下，注意<code>UserRepository</code>是<code>Interface</code>而不是<code>Class</code>：<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-IDEA2.png?raw=true" alt="Alt text"></p>
<h3 id="Step7-编写测试方法，检测连通性"><a href="#Step7-编写测试方法，检测连通性" class="headerlink" title="Step7.编写测试方法，检测连通性"></a>Step7.编写测试方法，检测连通性</h3><p><strong>转到<code>src/test/java/com.example.demo/</code>,注意是<u><code>test</code></u>中，创建一个<code>repository</code>包，添加<code>UserRepositoryTest</code>类用来测试，代码如下：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.BeforeEach;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.autoconfigure.jdbc.AutoConfigureTestDatabase;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.annotation.Rollback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.assertj.core.api.Assertions.assertThat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@DataJpaTest</span></span><br><span class="line"><span class="meta">@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)</span></span><br><span class="line"><span class="comment">//↑这句非常重要，JPA单元测试时，会自动切换到内嵌数据库，使用这个语句把它关掉，不然你头想破了都不知道为什么测试连不上数据库</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRepositoryTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TestEntityManager entityManager;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> User testUser;</span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setUp</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Setting up test environment...&quot;</span>);</span><br><span class="line">        <span class="comment">// 创建测试用户</span></span><br><span class="line">        testUser = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        testUser.setUsername(<span class="string">&quot;zzb&quot;</span>);</span><br><span class="line">        testUser.setPassword(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        testUser.setGender(<span class="string">&quot;male&quot;</span>);</span><br><span class="line">        testUser.setBirthdate(LocalDate.of(<span class="number">1998</span>, <span class="number">3</span>, <span class="number">3</span>));</span><br><span class="line">        testUser.setAddress(<span class="string">&quot;Example Address&quot;</span>);</span><br><span class="line">        testUser.setPepolename(<span class="string">&quot;zzb&quot;</span>);</span><br><span class="line">        testUser.setPepoleid(<span class="string">&quot;123456789123456789&quot;</span>);</span><br><span class="line">        <span class="comment">// 将测试用户插入到数据库中</span></span><br><span class="line">        entityManager.persist(testUser);</span><br><span class="line">        System.out.println(<span class="string">&quot;Inserted user ID: &quot;</span> + testUser.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@Rollback(false)</span><span class="comment">//←控制测试创建的数据是否回滚，这里用false，防止出现&quot;数据库连接幻觉&quot;情况</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">whenFindByUsername_thenReturnUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Running whenFindByUsername_thenReturnUser test...&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">foundUser</span> <span class="operator">=</span> userRepository.findByUsername(testUser.getUsername());</span><br><span class="line"></span><br><span class="line">        assertThat(foundUser).isNotNull().usingRecursiveComparison().isEqualTo(testUser);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (foundUser == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;User not found by username.&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Found user with ID: &quot;</span> + foundUser.getId());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSaveUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 创建新用户并保存</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">newUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        newUser.setUsername(<span class="string">&quot;zyy&quot;</span>);</span><br><span class="line">        newUser.setPassword(<span class="string">&quot;newpassword&quot;</span>);</span><br><span class="line">        newUser.setGender(<span class="string">&quot;female&quot;</span>); <span class="comment">// 使用String类型的gender</span></span><br><span class="line">        newUser.setBirthdate(LocalDate.of(<span class="number">1993</span>, <span class="number">3</span>, <span class="number">3</span>));</span><br><span class="line">        newUser.setAddress(<span class="string">&quot;New Example Address&quot;</span>);</span><br><span class="line">        newUser.setPepolename(<span class="string">&quot;zyy&quot;</span>);</span><br><span class="line">        newUser.setPepoleid(<span class="string">&quot;12345678912345678X&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">savedUser</span> <span class="operator">=</span> userRepository.save(newUser);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 确认新用户的ID已生成（即成功保存）</span></span><br><span class="line">        assertThat(savedUser.getId()).isNotNull();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 可选：验证新用户是否可以被找到</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">foundUser</span> <span class="operator">=</span> userRepository.findByUsername(<span class="string">&quot;zyy&quot;</span>);</span><br><span class="line">        assertThat(foundUser).isNotNull().usingRecursiveComparison().isEqualTo(savedUser);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (savedUser == <span class="literal">null</span> || foundUser == <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Failed to save or find the new user.&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Saved and found user with ID: &quot;</span> + savedUser.getId());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>做完这些之后我们的项目结构<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-IDEA3.png?raw=true" alt="Alt text"><br>你可能会发现<code>AutoConfigureTestDatabase</code>和<code>localDate</code>这两个类没有导入，导入一下就完事了。<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-IDEA4.png?raw=true" alt="Alt text"></p>
<p>搞定，重新构建一下，没有报错就可以跑一下测试了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew test</span><br></pre></td></tr></table></figure>

<p>测试完成，没有报错，刷新表之后在Navicat中看到我们测试用例创建的新用户<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-Navicat0.png?raw=true" alt="Alt text"><br>搞定~</p>
<h3 id="Step8-给前端提供功能"><a href="#Step8-给前端提供功能" class="headerlink" title="Step8:给前端提供功能"></a>Step8:给前端提供功能</h3><p>对于用户相关的操作，我们提供注册、登录等功能。<br>其中，能操作所有数据的管理员功能我们写到<code>controller</code>内<br>而普通用户需要用到的操作，我们写到<code>service</code>内</p>
<p>首先我们创建一个<code>service</code>包，然后创建一个<code>UserService</code>接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    User <span class="title function_">validateUser</span><span class="params">(String username, String password)</span>;</span><br><span class="line">    User <span class="title function_">registerUser</span><span class="params">(User user)</span> <span class="keyword">throws</span> IllegalArgumentException; <span class="comment">// 注册用户</span></span><br><span class="line">    User <span class="title function_">updateUserInfo</span><span class="params">(Integer userId, User userDetails)</span> <span class="keyword">throws</span> IllegalArgumentException; <span class="comment">// 修改用户信息</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updatePassword</span><span class="params">(Integer userId, String oldPassword, String newPassword)</span> <span class="keyword">throws</span> IllegalArgumentException; <span class="comment">// 修改密码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后，我们用再在<code>service</code>内创建实现其功能的包<code>impl</code>，在<code>service.impl</code>内创建实现这个接口的类<code>UserServiceImpl</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.example.demo.repository.UserRepository;</span><br><span class="line"><span class="keyword">import</span> com.example.demo.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">validateUser</span><span class="params">(String username, String password)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userRepository.findByUsername(username);</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span> &amp;&amp; user.getPassword().equals(password)) &#123;</span><br><span class="line">            <span class="keyword">return</span> user;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">registerUser</span><span class="params">(User user)</span> <span class="keyword">throws</span> IllegalArgumentException &#123;</span><br><span class="line">        <span class="comment">// 检查用户名是否已存在</span></span><br><span class="line">        <span class="keyword">if</span> (userRepository.findByUsername(user.getUsername()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;用户名已存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 检查密码长度</span></span><br><span class="line">        <span class="keyword">if</span> (user.getPassword().length() &lt; <span class="number">6</span> || user.getPassword().length() &gt; <span class="number">255</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;密码长度必须在 6 到 255 个字符之间&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 保存用户</span></span><br><span class="line">        <span class="keyword">return</span> userRepository.save(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">updateUserInfo</span><span class="params">(Integer userId, User userDetails)</span> <span class="keyword">throws</span> IllegalArgumentException &#123;</span><br><span class="line">        Optional&lt;User&gt; optionalUser = userRepository.findById(userId);</span><br><span class="line">        <span class="keyword">if</span> (optionalUser.isPresent()) &#123;</span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> optionalUser.get();</span><br><span class="line">            user.setUsername(userDetails.getUsername());</span><br><span class="line">            user.setGender(userDetails.getGender());</span><br><span class="line">            user.setBirthdate(userDetails.getBirthdate());</span><br><span class="line">            user.setAddress(userDetails.getAddress());</span><br><span class="line">            user.setPepoleid(userDetails.getPepoleid());</span><br><span class="line">            user.setPepolename(userDetails.getPepolename());</span><br><span class="line">            <span class="keyword">return</span> userRepository.save(user);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;用户不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updatePassword</span><span class="params">(Integer userId, String oldPassword, String newPassword)</span> <span class="keyword">throws</span> IllegalArgumentException &#123;</span><br><span class="line">        Optional&lt;User&gt; optionalUser = userRepository.findById(userId);</span><br><span class="line">        <span class="keyword">if</span> (optionalUser.isPresent()) &#123;</span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> optionalUser.get();</span><br><span class="line">            <span class="comment">// 验证旧密码</span></span><br><span class="line">            <span class="keyword">if</span> (!user.getPassword().equals(oldPassword)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;旧密码错误&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 更新密码</span></span><br><span class="line">            user.setPassword(newPassword);</span><br><span class="line">            userRepository.save(user);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;用户不存在&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于查询所有账户的信息，对账户信息的增删改查等管理员权限的功能，我们写在<code>controller</code>包的<code>UserController</code>类中，当然，为了调用方便，我们也在这个类中应用<code>UserService</code>的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.demo.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.example.demo.repository.UserRepository;</span><br><span class="line"><span class="keyword">import</span> com.example.demo.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.ResponseEntity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/api/users&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//调用UserService接口，登录的验证使用UserService</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 登录接口</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;?&gt; login(<span class="meta">@RequestBody</span> User loginRequest) &#123;</span><br><span class="line">        <span class="comment">// 调用 UserService 验证用户</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.validateUser(loginRequest.getUsername(), loginRequest.getPassword());</span><br><span class="line">        <span class="keyword">if</span> (user != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 登录成功，返回用户信息</span></span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.ok(user);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 登录失败，返回错误信息</span></span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.badRequest().body(<span class="string">&quot;用户名或密码错误&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//调用UserRepository接口，对账户的控制函数都实现于本文件内。</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取所有用户</span></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">getAllUsers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userRepository.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据ID获取用户</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;User&gt; <span class="title function_">getUserById</span><span class="params">(<span class="meta">@PathVariable(value = &quot;id&quot;)</span> Integer userId)</span> &#123;</span><br><span class="line">        Optional&lt;User&gt; user = userRepository.findById(userId);</span><br><span class="line">        <span class="keyword">if</span> (user.isPresent()) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.ok().body(user.get());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.notFound().build();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建新用户</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">createUser</span><span class="params">(<span class="meta">@RequestBody</span> User newUser)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userRepository.save(newUser);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新用户信息</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;User&gt; <span class="title function_">updateUser</span><span class="params">(<span class="meta">@PathVariable(value = &quot;id&quot;)</span> Integer userId, <span class="meta">@RequestBody</span> User userDetails)</span> &#123;</span><br><span class="line">        Optional&lt;User&gt; optionalUser = userRepository.findById(userId);</span><br><span class="line">        <span class="keyword">if</span> (optionalUser.isPresent()) &#123;</span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> optionalUser.get();</span><br><span class="line">            user.setUsername(userDetails.getUsername());</span><br><span class="line">            user.setPassword(userDetails.getPassword());</span><br><span class="line">            user.setGender(userDetails.getGender());</span><br><span class="line">            user.setBirthdate(userDetails.getBirthdate());</span><br><span class="line">            user.setAddress(userDetails.getAddress());</span><br><span class="line">            user.setPepoleid(userDetails.getPepoleid());</span><br><span class="line">            user.setPepolename(userDetails.getPepolename());</span><br><span class="line">            <span class="keyword">final</span> <span class="type">User</span> <span class="variable">updatedUser</span> <span class="operator">=</span> userRepository.save(user);</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.ok(updatedUser);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.notFound().build();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除用户</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;Void&gt; <span class="title function_">deleteUser</span><span class="params">(<span class="meta">@PathVariable(value = &quot;id&quot;)</span> Integer userId)</span> &#123;</span><br><span class="line">        Optional&lt;User&gt; user = userRepository.findById(userId);</span><br><span class="line">        <span class="keyword">if</span> (user.isPresent()) &#123;</span><br><span class="line">            userRepository.delete(user.get());</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.ok().build();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.notFound().build();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意添加完成后重新构建一下。</p>
<h2 id="2-0-前端：VUE-这是什么？"><a href="#2-0-前端：VUE-这是什么？" class="headerlink" title="2.0.前端：VUE?这是什么？"></a>2.0.前端：VUE?这是什么？</h2><p>好吧，找一下发现<a target="_blank" rel="noopener" href="https://cn.vuejs.org/guide/introduction.html">VUE</a>是JavaScript的框架，那还是要<a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn">Node.js</a>的运行环境，装就完事了。node.js的安装还是很简单的，笔者是Windows11环境，使用pnpm安装就完事了。</p>
<figure class="highlight ps1"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Download and install fnm:</span></span><br><span class="line">winget install Schniz.fnm</span><br><span class="line"></span><br><span class="line"><span class="comment"># Download and install Node.js:</span></span><br><span class="line">fnm install <span class="number">22</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Verify the Node.js version:</span></span><br><span class="line">node <span class="literal">-v</span> <span class="comment"># Should print &quot;v22.14.0&quot;.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Download and install pnpm:</span></span><br><span class="line">corepack enable pnpm</span><br><span class="line"></span><br><span class="line"><span class="comment"># Verify pnpm version:</span></span><br><span class="line">pnpm <span class="literal">-v</span></span><br></pre></td></tr></table></figure>

<p>ok，安装完成，node -v能出现版本号了。</p>
<h3 id="Vite-强大的Vue构建工具"><a href="#Vite-强大的Vue构建工具" class="headerlink" title="Vite:强大的Vue构建工具"></a>Vite:强大的Vue构建工具</h3><p>OK，导师说装个<a target="_blank" rel="noopener" href="https://vitejs.cn/vite3-cn/guide/">Vite</a>更方便，问一下AI这玩意干啥的。</p>
<blockquote>
<p>Generated from Qwen:<br>Vite 是一个现代化的前端构建工具，旨在显著提升前端开发体验。它主要由两大部分组成：一个是开发服务器，另一个是用于生产环境的构建指令。</p>
</blockquote>
<p>装就完事了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-vite</span><br></pre></td></tr></table></figure>

<p>OK装好之后就可以用create-vite来方便地创建一个Demo了。</p>
<p>创建并进入一个我们打算存放Demo的地方，然后运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create-vite vue_demo --template vue</span><br><span class="line">Scaffolding project in </span><br><span class="line"></span><br><span class="line">vue_demo...</span><br><span class="line"></span><br><span class="line">Done. Now run:</span><br><span class="line"></span><br><span class="line">  cd vue_demo</span><br><span class="line">  npm install</span><br><span class="line">  npm run dev</span><br></pre></td></tr></table></figure>

<p>OK,接下来按照指引运行一下这三个命令，就能运行我们的Demo了。</p>
<hr>
<h3 id="安装和配置必要的组件库"><a href="#安装和配置必要的组件库" class="headerlink" title="安装和配置必要的组件库"></a>安装和配置必要的组件库</h3><p>当然，此时的Demo还是空的，我们还需要安装一些必要的组件库，比如axios、vue-router、Element Plus等，才能满足我们对页面的各种各样的需求。</p>
<h4 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h4><h5 id="安装-Axios："><a href="#安装-Axios：" class="headerlink" title="安装 Axios："></a>安装 Axios：</h5><p><code>Axios</code>用于发送Http请求给后端API。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure>

<h5 id="配置-Axios："><a href="#配置-Axios：" class="headerlink" title="配置 Axios："></a>配置 Axios：</h5><p>我们还需要创建一个文件来封装它，以便于管理和维护。</p>
<ol>
<li>创建一个新的文件 <code>src/api/index.js</code>：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> instance = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>: <span class="string">&#x27;http://localhost:8080/api/&#x27;</span>, <span class="comment">// 设置默认的API地址</span></span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">5000</span>, <span class="comment">// 请求超时时间</span></span><br><span class="line">    <span class="attr">headers</span>: &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> instance;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>创建 axios 实例</li>
</ol>
<p>在<code>src</code>目录下创建一个<code>utils</code>文件夹，并在其中创建一个<code>http.js</code>文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> http = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&#x27;https://api.example.com&#x27;</span>, <span class="comment">// 我们的 API 地址</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span>, <span class="comment">// 请求超时时间</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">http.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 在发送请求之前做些什么</span></span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 对请求错误做些什么</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">http.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 对响应数据做些什么</span></span><br><span class="line">    <span class="keyword">return</span> response.<span class="property">data</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 对响应错误做些什么</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> http;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>在需要调用 API 的地方引入并使用这个实例：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="vue-router"><a href="#vue-router" class="headerlink" title="vue-router"></a>vue-router</h4><h5 id="安装-Vue-Router："><a href="#安装-Vue-Router：" class="headerlink" title="安装 Vue Router："></a>安装 Vue Router：</h5><p><code>Vue Router</code>用于管理页面路由，也就是我们在网页中经常用到的页面跳转功能。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-router</span><br></pre></td></tr></table></figure>

<h5 id="配置-Vue-Router："><a href="#配置-Vue-Router：" class="headerlink" title="配置 Vue Router："></a>配置 Vue Router：</h5><p>接下来，我们为 Vue 应用程序设置路由管理。</p>
<ol>
<li>创建路由配置文件 <code>src/router/index.js</code>：</li>
</ol>
<p><strong>这里病历页面使用<code>/medical-records/:userId</code>的方式进行访问。</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Home.vue&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Login.vue&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/register&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Register&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/Register.vue&#x27;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/medical-records/:userId&#x27;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;MedicalRecords&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">&#x27;@/views/MedicalRecords.vue&#x27;</span>),</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">  <span class="attr">history</span>: <span class="title function_">createWebHistory</span>(),</span><br><span class="line">  routes,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在 <code>main.js</code> 或 <code>main.ts</code> 中引入并使用路由：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementPlus</span> <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;element-plus/dist/index.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br><span class="line">app.<span class="title function_">use</span>(router);<span class="comment">//router</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title class_">ElementPlus</span>);<span class="comment">//el</span></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>);</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="Element-Plus"><a href="#Element-Plus" class="headerlink" title="Element Plus"></a>Element Plus</h4><h5 id="安装-Element-Plus："><a href="#安装-Element-Plus：" class="headerlink" title="安装 Element Plus："></a>安装 Element Plus：</h5><p>最后安装<code>Element Plus</code>用于快速开发UI界面。<br>顺便再装一个自动引入的插件，这样我们就可以直接使用Element Plus的组件而无需手动导入每个组件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install element-plus</span><br><span class="line">npm install unplugin-auto-import unplugin-vue-components -D</span><br></pre></td></tr></table></figure>

<h5 id="配置-Element-Plus："><a href="#配置-Element-Plus：" class="headerlink" title="配置 Element Plus："></a>配置 Element Plus：</h5><p>对于 Element Plus，我们可以选择完整引入或按需引入。这里推荐使用按需引入以减少打包体积。</p>
<p>修改 <code>vite.config.js</code> 文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&#x27;vite&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&#x27;@vitejs/plugin-vue&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span>; <span class="comment">// 需要引入 path 模块</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title function_">vue</span>()],</span><br><span class="line">  <span class="attr">resolve</span>: &#123;</span><br><span class="line">    <span class="attr">alias</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./src&#x27;</span>), <span class="comment">// 将 @ 指向 src 目录</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>这样，你就可以在我们的组件中直接使用 Element Plus 的组件而无需手动导入每个组件。</p>
<p>通过以上步骤，你应该能够在我们的 Vite + Vue 项目中成功配置和使用 <code>axios</code>、<code>vue-router</code> 和 <code>Element Plus</code>。记得根据实际需求调整配置和代码逻辑。</p>
<hr>
<h3 id="页面编写"><a href="#页面编写" class="headerlink" title="页面编写"></a>页面编写</h3><p>好了，接下来就可以开始写登录界面的代码了。<br>我们在之前配置 Vue Router的时候已经指定了<code>Home</code>、<code>Login</code>和<code>Register</code>三个文件的路径，他们是在<code>views</code>目录下的，所以我们要先在根目录<code>src</code>下创建<code>views</code>文件夹，然后在里面创建<code>Home.vue</code>、<code>Login.vue</code>和<code>Register.vue</code>，分别对应首页、登录页和注册页，<code>MedicalRecords.vue</code>则是病历的动态页面。</p>
<p>之后，我们的项目目录应该看起来像这样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">src/</span><br><span class="line">├── assets/</span><br><span class="line">├── components/</span><br><span class="line">├── router/</span><br><span class="line">│   └── index.js</span><br><span class="line">├── utils/</span><br><span class="line">│   └── http.js</span><br><span class="line">├── views/</span><br><span class="line">│   ├── Home.vue</span><br><span class="line">│   ├── Login.vue</span><br><span class="line">│   ├── MedicalRecords.vue</span><br><span class="line">│   └── Register.vue</span><br><span class="line">├── App.vue</span><br><span class="line">└── main.js</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h4 id="Home-vue"><a href="#Home-vue" class="headerlink" title="Home.vue:"></a>Home.vue:</h4><p>随便写点东西在Home(其实一开始是想在这个界面显示数据库中最近创建的16个用户，不过写完是一坨bug，所以就这样吧，不完整但是无伤大雅)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome to Home Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;fetchData&quot;</span>&gt;</span>Fetch Data<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 数据展示 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;tableData&quot;</span> <span class="attr">v-loading</span>=<span class="string">&quot;loading&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-top: 20px&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;ID&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;title&quot;</span> <span class="attr">label</span>=<span class="string">&quot;Title&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tableData</span>: [], <span class="comment">// 表格数据</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">loading</span>: <span class="literal">false</span>, <span class="comment">// 加载状态</span></span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">fetchData</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 调用 API 获取数据</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> response = <span class="keyword">await</span> http.<span class="title function_">get</span>(<span class="string">&#x27;/posts&#x27;</span>); <span class="comment">// 假设 API 返回一个帖子列表</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">tableData</span> = response;</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;Failed to fetch data&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">finally</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">loading</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">h1</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: <span class="number">#409EFF</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.el-button</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Login-vue"><a href="#Login-vue" class="headerlink" title="Login.vue:"></a>Login.vue:</h4><p>登录成功之后使用router将UserId传给之后的页面，用于传递用户信息，当然使用会话也很好，有验证机制，这里先用URL保存用户ID</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-container</span> <span class="attr">class</span>=<span class="string">&quot;login-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-card</span> <span class="attr">class</span>=<span class="string">&quot;login-card&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>用户登录<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;loginForm&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;loginRules&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;loginFormRef&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;80px&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 用户名 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;用户名&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;loginForm.username&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 密码 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;密码&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;loginForm.password&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;password&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">show-password</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 登录按钮 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleLogin&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;resetForm&quot;</span>&gt;</span>重置<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-card</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span>; <span class="comment">// 引入 axios 实例</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span>; <span class="comment">// 引入 Element Plus 的消息提示组件</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">loginForm</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">loginRules</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">username</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入用户名&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123; <span class="attr">min</span>: <span class="number">3</span>, <span class="attr">max</span>: <span class="number">50</span>, <span class="attr">message</span>: <span class="string">&#x27;用户名长度在 3 到 50 个字符&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        ],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">password</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入密码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123; <span class="attr">min</span>: <span class="number">6</span>, <span class="attr">max</span>: <span class="number">255</span>, <span class="attr">message</span>: <span class="string">&#x27;密码长度在 6 到 255 个字符&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        ],</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">handleLogin</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">loginFormRef</span>.<span class="title function_">validate</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> response = <span class="keyword">await</span> http.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="variable language_">this</span>.<span class="property">loginForm</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&#x27;登录成功&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> userId = response.<span class="property">data</span>.<span class="property">userId</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;user&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(response.<span class="property">data</span>));</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;MedicalRecords&#x27;</span>, <span class="attr">params</span>: &#123; userId &#125; &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">message</span> || <span class="string">&#x27;登录失败&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&#x27;登录失败，请检查用户名和密码&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">resetForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">loginFormRef</span>.<span class="title function_">resetFields</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.login-container</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#f5f5f5</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.login-card</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">width</span>: <span class="number">400px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">h2</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">color</span>: <span class="number">#409EFF</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果是这样<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-View-Login.png?raw=true" alt="Alt text"></p>
<hr>
<h4 id="Register-vue"><a href="#Register-vue" class="headerlink" title="Register.vue:"></a>Register.vue:</h4><p>给每个输入都做了判定和单独的提示，如果输入不合法，则不会发送请求，并且会有提示。</p>
<p>其中，比较有创新的地方是</p>
<ol>
<li>按照出生日期在前端实时刷新年龄，当前时间减去出生日期，并将计算结果显示在前端。</li>
<li>限制了出生日期只能选择在今天以前的日期。</li>
<li>对身份证号有特殊检查，只能是18位，并且前17位必须是数字，最后一位可以是数字或者X。</li>
</ol>
<p>其他数据的检查稀松平常，看代码吧。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-container</span> <span class="attr">class</span>=<span class="string">&quot;register-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-main</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-card</span> <span class="attr">class</span>=<span class="string">&quot;register-card&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h2</span>&gt;</span>用户注册<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;registerForm&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;registerRules&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;registerFormRef&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;100px&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 用户名 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;用户名&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;registerForm.username&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">            <span class="comment">&lt;!-- 密码 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;密码&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;registerForm.password&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span> <span class="attr">show-password</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">            <span class="comment">&lt;!-- 确认密码 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;确认密码&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;confirmPassword&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;registerForm.confirmPassword&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请再次输入密码&quot;</span> <span class="attr">show-password</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">            <span class="comment">&lt;!-- 性别 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;性别&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;gender&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-radio-group</span> <span class="attr">v-model</span>=<span class="string">&quot;registerForm.gender&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">label</span>=<span class="string">&quot;male&quot;</span>&gt;</span>男<span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">label</span>=<span class="string">&quot;female&quot;</span>&gt;</span>女<span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">label</span>=<span class="string">&quot;other&quot;</span>&gt;</span>其他<span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">el-radio-group</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">            <span class="comment">&lt;!-- 出生日期和年龄 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;12&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;出生日期&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;birthdate&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">el-date-picker</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">v-model</span>=<span class="string">&quot;registerForm.birthdate&quot;</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">type</span>=<span class="string">&quot;date&quot;</span> </span></span><br><span class="line"><span class="tag">                    <span class="attr">placeholder</span>=<span class="string">&quot;选择日期&quot;</span></span></span><br><span class="line"><span class="tag">                    @<span class="attr">change</span>=<span class="string">&quot;calculateAge&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">:disabled-date</span>=<span class="string">&quot;disabledDate&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                </span><br><span class="line">              <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;12&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;年龄&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">:value</span>=<span class="string">&quot;age&quot;</span> <span class="attr">disabled</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">            <span class="comment">&lt;!-- 地址 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;地址&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;address&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;registerForm.address&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入地址&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">            <span class="comment">&lt;!-- 姓名 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;姓名&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;realName&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;registerForm.realName&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入您的真实姓名&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- 身份证号 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;身份证号&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;idNumber&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;registerForm.idNumber&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入您的身份证号码&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- 注册按钮 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleRegister&quot;</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;resetForm&quot;</span>&gt;</span>重置<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-card</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span>; <span class="comment">// 引入 axios 实例</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;element-plus&#x27;</span>; <span class="comment">// 引入 Element Plus 的消息提示组件</span></span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;Register&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">validateConfirmPassword</span> = (<span class="params">rule, value, callback</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (value !== <span class="variable language_">this</span>.<span class="property">registerForm</span>.<span class="property">password</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;两次输入的密码不一致&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">callback</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">registerForm</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">confirmPassword</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">gender</span>: <span class="string">&#x27;male&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">birthdate</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">address</span>: <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">age</span>: <span class="literal">null</span>, <span class="comment">// 新增用于存储计算出来的年龄</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">registerRules</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">username</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入用户名&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">min</span>: <span class="number">3</span>, <span class="attr">max</span>: <span class="number">50</span>, <span class="attr">message</span>: <span class="string">&#x27;用户名长度在 3 到 50 个字符&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">password</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入密码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">min</span>: <span class="number">6</span>, <span class="attr">max</span>: <span class="number">255</span>, <span class="attr">message</span>: <span class="string">&#x27;密码长度在 6 到 255 个字符&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">confirmPassword</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请再次输入密码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">validator</span>: validateConfirmPassword, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">gender</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请选择性别&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;change&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">birthdate</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请选择出生日期&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;change&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">address</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入地址&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">realName</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入您的真实姓名&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        ],</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">idNumber</span>: [</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入您的身份证号码&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#123; <span class="attr">min</span>: <span class="number">18</span>, <span class="attr">max</span>: <span class="number">18</span>, <span class="attr">message</span>: <span class="string">&#x27;身份证号码必须是18位&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;, <span class="comment">// 检查长度</span></span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">pattern</span>: <span class="regexp">/^[0-9]&#123;17&#125;[0-9X]$/</span>, <span class="comment">// 正则表达式，确保只包含数字和最后一位可能是X</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">message</span>: <span class="string">&#x27;身份证号码格式不正确，只能包含数字和最后一位可能是大写字母X&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        ],</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">disabledDate</span>(<span class="params">time</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> time.<span class="title function_">getTime</span>() &gt; <span class="title class_">Date</span>.<span class="title function_">now</span>(); <span class="comment">// 只能选择今天之前(不含今天)的日期</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">calculateAge</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">registerForm</span>.<span class="property">birthdate</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> today = <span class="keyword">new</span> <span class="title class_">Date</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> birthDate = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="variable language_">this</span>.<span class="property">registerForm</span>.<span class="property">birthdate</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> years = today.<span class="title function_">getFullYear</span>() - birthDate.<span class="title function_">getFullYear</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> monthDiff = today.<span class="title function_">getMonth</span>() - birthDate.<span class="title function_">getMonth</span>();</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (monthDiff &lt; <span class="number">0</span> || (monthDiff === <span class="number">0</span> &amp;&amp; today.<span class="title function_">getDate</span>() &lt; birthDate.<span class="title function_">getDate</span>())) &#123;</span></span><br><span class="line"><span class="language-javascript">            years--;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">age</span> = years;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">age</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">async</span> <span class="title function_">handleRegister</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">registerFormRef</span>.<span class="title function_">validate</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> response = <span class="keyword">await</span> http.<span class="title function_">post</span>(<span class="string">&#x27;/api/users/register&#x27;</span>, <span class="variable language_">this</span>.<span class="property">registerForm</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (response.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&#x27;注册成功&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(<span class="string">&#x27;/login&#x27;</span>); <span class="comment">// 跳转到登录页面</span></span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">message</span> || <span class="string">&#x27;注册失败&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(error.<span class="property">response</span>?.<span class="property">data</span>?.<span class="property">message</span> || <span class="string">&#x27;注册失败，请检查输入&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">resetForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">registerFormRef</span>.<span class="title function_">resetFields</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">age</span> = <span class="literal">null</span>; <span class="comment">// 重置时也需重置年龄</span></span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.register-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#f5f5f5</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  </span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.register-card</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  </span></span><br><span class="line"><span class="language-css">  <span class="selector-tag">h2</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#409EFF</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果截图贴这，我主要技术栈是单片机方向的，所以页面主打一个能用就行，不太美观。</p>
<p><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-View-Register0.png?raw=true" alt="Alt text"></p>
<p>在酒吧点个炒饭看看<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-View-Register1.png?raw=true" alt="Alt text"><br>好，全防住了</p>
<h4 id="MedicalRecords-vue"><a href="#MedicalRecords-vue" class="headerlink" title="MedicalRecords.vue"></a>MedicalRecords.vue</h4><p>通过URL传递的用户ID，对后端进行访问，查询到用户的病历数据</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;medical-records&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 病历列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;medicalRecords&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;diagnosisDate&quot;</span> <span class="attr">label</span>=<span class="string">&quot;诊断日期&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;doctor&quot;</span> <span class="attr">label</span>=<span class="string">&quot;医生&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;diagnosis&quot;</span> <span class="attr">label</span>=<span class="string">&quot;诊断&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;handleDetail(scope.row)&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span>&gt;</span>查看详情<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 病历详情对话框 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">title</span>=<span class="string">&quot;病历详情&quot;</span> <span class="attr">:visible.sync</span>=<span class="string">&quot;dialogVisible&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>诊断日期: &#123;&#123; currentRecord.diagnosisDate &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>医生: &#123;&#123; currentRecord.doctor &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>诊断: &#123;&#123; currentRecord.diagnosis &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>备注: &#123;&#123; currentRecord.remark &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;footer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = false&quot;</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123; useRoute &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">userId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">medicalRecords</span>: [],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">dialogVisible</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">currentRecord</span>: &#123;&#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> route = <span class="title function_">useRoute</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="property">userId</span> = route.<span class="property">params</span>.<span class="property">userId</span>; <span class="comment">// 从路由参数中获取userId</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">fetchMedicalRecords</span>(); <span class="comment">// 页面加载时调用此方法获取病历数据</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">fetchMedicalRecords</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      axios.<span class="title function_">get</span>(<span class="string">&#x27;/api/medicalRecords&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">params</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">userId</span>: <span class="variable language_">this</span>.<span class="property">userId</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">medicalRecords</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;获取病历记录失败:&#x27;</span>, error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">handleDetail</span>(<span class="params">record</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">currentRecord</span> = record;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.medical-records</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果图<br><img src="https://github.com/Zaiyuyou/zaiyuyou.github.io/blob/main/source/_posts/images/2025-2-24/2025-03-03-View-MedicalRecords0.png" alt="Alt text"></p>
<h2 id="系统漏洞分析"><a href="#系统漏洞分析" class="headerlink" title="系统漏洞分析"></a>系统漏洞分析</h2><ol>
<li>后端没有编写对发送过来的表单进行二次审查的功能，所以很容易被攻击输入非法数据甚至是SQL注入，安全性几乎是0。</li>
<li>用户输入的所有数据都是透明传输，所以用户输入的数据很容易被窃取。</li>
</ol>
<p>虽然这些系统上的问题都可以通过增加功能进行防御，我都想写，但是时间上来不及了，手上也没有现成的开源模块可以直接塞进去(手上能用的是Python的代码)，不过还是在这里简单总结一下，谨留以后效。 </p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>至此，我们完成了对用户注册和登录功能的开发，并添加了表单验证和错误处理。现在，用户可以注册他们的账户，并且系统会根据输入的数据进行验证，确保数据的完整性和准确性现在我们了解了怎么在IDEA中用SpringBoot进行数据库方面的开发，另外学了一些前端的知识，也算是前端成功入门了，技能+++++……</p>
<h3 id="本文使用过的AI工具："><a href="#本文使用过的AI工具：" class="headerlink" title="本文使用过的AI工具："></a>本文使用过的AI工具：</h3><p><a target="_blank" rel="noopener" href="https://tongyi.aliyun.com/qianwen/">Qwen</a><br><a target="_blank" rel="noopener" href="https://chat.deepseek.com/">DeepSeek</a></p>
<p>在遇到一些技术问题，比如在测试中怎么取消测试用例的回滚，以及怎么防止测试用例访问自己的H2数据库而不是我的Mysql这些问题上，感谢这些AI帮我解决了这些关键问题,顺便还了解了JPA和EntityManager的知识，爽！AI技术进步和开源真好，在AI工具的帮助下，我学东西都快了不少。</p>

        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2024-8-03-01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2024/08/02/2024-8-03-01/">shell控制语句</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-08-02T16:00:00.000Z" itemprop="datePublished">2024-08-03</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Linux/">Linux</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            735 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="shell控制语句"><a href="#shell控制语句" class="headerlink" title="shell控制语句"></a>shell控制语句</h1><h2 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h2><p>注意 <code>if</code> 后面要接 <code>then</code>,<code>else</code>后不需要，用<code>fi</code>表示结束<code>if</code>语句。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition ]; </span><br><span class="line">    <span class="keyword">then</span> <span class="comment"># do something</span></span><br><span class="line"><span class="keyword">elif</span> [ condition ]; </span><br><span class="line">    <span class="keyword">then</span> <span class="comment"># do something</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="comment"># do something</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="case语句"><a href="#case语句" class="headerlink" title="case语句"></a>case语句</h2><p><code>case</code>后面接<code>变量</code>+<code>in</code>，相当于C语言中的<code>switch</code>，</p>
<p>用<code>value</code> + <code>)</code>表示<code>case</code>的值，可以用<code>|</code>将多个运行值连接</p>
<p><code>&quot;*&quot;</code>是在这里被视作通配符，可以用类似<code>&quot;Bob*&quot;)</code>过滤出Bob开头的变量的情况，可以用单一个<code>&quot;*&quot;</code>表示C语言中<code>default</code>的情况，</p>
<p>用<code>;;</code>表示跳出<code>case</code>语句段，</p>
<p>用<code>esac</code>表示结束<code>case</code>语句</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;This script will print your choice&quot;</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">    <span class="string">&quot;one&quot;</span> | <span class="string">&quot;1&quot;</span> | <span class="string">&quot;first&quot;</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;You have chosen one&quot;</span></span><br><span class="line">    ;;</span><br><span class="line">    <span class="string">&quot;two&quot;</span> | <span class="string">&quot;2&quot;</span> | <span class="string">&quot;second&quot;</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;You have chosen two&quot;</span></span><br><span class="line">    ;;</span><br><span class="line">    *)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Error Please try Again&quot;</span></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> item1 item2 ... itemN</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment"># do something</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> condition</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment"># do something</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="until循环"><a href="#until循环" class="headerlink" title="until循环"></a>until循环</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">until</span> condition</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment"># do something</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>


        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2024-8-07-01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2024/08/02/2024-8-07-01/">字节序转换函数</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-08-02T16:00:00.000Z" itemprop="datePublished">2024-08-03</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Linux/">Linux</a>><a class="meta-cate-link" href="/categories/Linux/%E7%BC%96%E7%A8%8B/">编程</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            593 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C%E8%AF%AD%E8%A8%80/" rel="tag">C语言</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="主机字节序"><a href="#主机字节序" class="headerlink" title="主机字节序"></a>主机字节序</h2><p>主机字节序就是主机存储数据的顺序，有<strong>大端序</strong>和<strong>小端序</strong>两种</p>
<ul>
<li>大端序：高位字节存储在低地址上，低位字节存储在高地址上</li>
<li>小端序：低位字节存储在低地址上，高位字节存储在高地址上</li>
</ul>
<h2 id="网络字节序"><a href="#网络字节序" class="headerlink" title="网络字节序"></a>网络字节序</h2><p>网络字节序就是网络传输数据的顺序，规定为<strong>大端序</strong></p>
<h2 id="主机字节序转网络字节序"><a href="#主机字节序转网络字节序" class="headerlink" title="主机字节序转网络字节序"></a>主机字节序转网络字节序</h2><h3 id="htonl"><a href="#htonl" class="headerlink" title="htonl"></a>htonl</h3><p><strong>Host to Network Long</strong><br>将主机字节序转换成网络字节序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> <span class="title function_">htonl</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> hostlong)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="htons"><a href="#htons" class="headerlink" title="htons"></a>htons</h3><p><strong>Host to Network Short</strong><br>将主机字节序转换成网络字节序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span> <span class="title function_">htons</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span> hostshort)</span>;</span><br></pre></td></tr></table></figure>

<h2 id="网络字节序转主机字节序"><a href="#网络字节序转主机字节序" class="headerlink" title="网络字节序转主机字节序"></a>网络字节序转主机字节序</h2><h3 id="ntohl"><a href="#ntohl" class="headerlink" title="ntohl"></a>ntohl</h3><p><strong>Network to Hos Long</strong><br>将网络字节序转换成主机字节序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> <span class="title function_">ntohl</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">int</span> netlong)</span>;</span><br></pre></td></tr></table></figure>



<h3 id="ntohs"><a href="#ntohs" class="headerlink" title="ntohs"></a>ntohs</h3><p><strong>Network to Host Short</strong><br>将网络字节序转换成主机字节序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span> <span class="title function_">ntohs</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="type">unsigned</span> <span class="type">short</span> <span class="type">int</span> netshort)</span>;</span><br></pre></td></tr></table></figure>
        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2024-7-31-01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2024/07/30/2024-7-31-01/">shell测试语句</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-07-30T16:00:00.000Z" itemprop="datePublished">2024-07-31</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Linux/">Linux</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            2.2k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="测试语句"><a href="#测试语句" class="headerlink" title="测试语句"></a>测试语句</h1><p>在编写shell脚本时，常遇到需要判断变量的值师傅相等，或者检查文件状态等，这时就需要测试语句进行测试才能决定下一步动作。shell脚本根据不同的数据类型设置了不同的条件语句的格式，使用test或者用中括号包围就可以执行条件测试语句，下面介绍常用的测试语句。</p>
<hr>
<h2 id="数值测试"><a href="#数值测试" class="headerlink" title="数值测试"></a>数值测试</h2><p>二元测试语句<br>数值测试用于比较两个数值的大小，常用的测试语句如下：</p>
<ul>
<li>-eq：等于(equal)</li>
<li>-ne：不等于(not equal)</li>
<li>-gt：大于(greater than)</li>
<li>-lt：小于(less than)</li>
<li>-ge：大于等于(greater than or equal to)</li>
<li>-le：小于等于(less than or equal to)</li>
</ul>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">num1=10</span><br><span class="line">num2=20</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$num1</span> -eq <span class="variable">$num2</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$num1</span> 等于 <span class="variable">$num2</span>&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$num1</span> 不等于 <span class="variable">$num2</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="字符串测试"><a href="#字符串测试" class="headerlink" title="字符串测试"></a>字符串测试</h2><p>二元测试语句<br>字符串测试用于比较两个字符串是否相等，常用的测试语句如下：</p>
<ul>
<li>&#x3D;：等于</li>
<li>!&#x3D;：不等于</li>
<li>-z：字符串长度为0</li>
<li>-n：字符串长度不为0</li>
</ul>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">str1=<span class="string">&quot;hello&quot;</span></span><br><span class="line">str2=<span class="string">&quot;world&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$str1</span> = <span class="variable">$str2</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$str1</span> 等于 <span class="variable">$str2</span>&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$str1</span> 不等于 <span class="variable">$str2</span>&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="文件测试"><a href="#文件测试" class="headerlink" title="文件测试"></a>文件测试</h2><p>文件测试分为文件状态测试和文件比较测试，以下是状态测试的部分</p>
<h3 id="文件状态测试"><a href="#文件状态测试" class="headerlink" title="文件状态测试"></a>文件状态测试</h3><p>一元测试语句<br>文件测试用于检查文件的状态，常用的测试语句如下：</p>
<ul>
<li>-e：文件存在(exist)</li>
<li>-s：文件是否非空</li>
<li>-S：文件是套接字文件(socket)</li>
<li>-L：文件是软链接文件(symbolic link)</li>
<li>-b：文件是块设备文件(block)</li>
<li>-c：文件是字符设备文件(character)</li>
<li>-d：文件是目录(dir)</li>
<li>-f：文件是普通文件(file)</li>
<li>-p：文件是管道文件(pipe)</li>
<li>-r：文件可读(readable)</li>
<li>-w：文件可写(writeable)</li>
<li>-x：文件可执行(executable)</li>
</ul>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">file=<span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="variable">$file</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> 存在&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> 不存在&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<h3 id="文件比较测试"><a href="#文件比较测试" class="headerlink" title="文件比较测试"></a>文件比较测试</h3><p>二元测试语句<br>文件比较测试用于比较文件的大小，修改时间等信息，常用的测试语句如下：</p>
<ul>
<li>-nt：文件1比文件2新(newer than)</li>
<li>-ot：文件1比文件2旧(older than)</li>
<li>-ef：文件1和文件2是同一个文件(equals file)(判断两个文件是否是硬链接)</li>
</ul>
<p>另外，还可以借用数值测试中的比较运算符进行文件大小比较，常用的测试语句如下：</p>
<ul>
<li>-eq：文件1和文件2大小相等(equal)</li>
<li>-ne：文件1和文件2大小不相等(not equal)</li>
<li>-le：文件1小于等于文件2(less than or equal)</li>
<li>-ge：文件1大于等于文件2(greater than or equal)</li>
</ul>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">file1=<span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line">file2=<span class="string">&quot;/etc/shadow&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$file1</span> -nt <span class="variable">$file2</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file1</span> 比 <span class="variable">$file2</span> 新&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file1</span> 比 <span class="variable">$file2</span> 旧&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="复合测试"><a href="#复合测试" class="headerlink" title="复合测试"></a>复合测试</h2><p>复合测试用于将多个测试条件组合在一起，常用的测试语句如下：</p>
<h3 id="命令执行控制语句："><a href="#命令执行控制语句：" class="headerlink" title="命令执行控制语句："></a>命令执行控制语句：</h3><ul>
<li>&amp;&amp;：逻辑与(and)</li>
<li>||：逻辑或(or)</li>
</ul>
<p>命令执行控制语句本质上是将多个命令的执行结果进行运算，并不能直接的将多个判断条件放在一条命令中</p>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span> -e /home &amp;&amp; <span class="built_in">test</span> -r /home</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">file=<span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="variable">$file</span> ] &amp;&amp; [ -r <span class="variable">$file</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> 存在并且可读&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> 不存在或者不可读&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<h3 id="多重条件判定语句："><a href="#多重条件判定语句：" class="headerlink" title="多重条件判定语句："></a>多重条件判定语句：</h3><ul>
<li>-a：逻辑与(and)</li>
<li>-o：逻辑或(or)</li>
<li>!：逻辑非(not)</li>
</ul>
<p>和命令执行控制语句不同，多重条件判断语句就是将多个条件用-a或者-o连接起来，如果条件为真，则整个表达式为真，否则为假。</p>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span> -e /home -a -r /home</span><br></pre></td></tr></table></figure>

<p>可以看到这条示例中相比于前面的命令执行控制语句，少了一个 <code>test</code> ，这是因为在多重条件判断语句中，<code>-a</code> 和 <code>-o</code> 是默认的，所以可以省略，同时被视作一条命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">file=<span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line"><span class="keyword">if</span> [ -e <span class="variable">$file</span> -a -r <span class="variable">$file</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> 存在并且可读&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$file</span> 不存在或者不可读&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="条件表达式"><a href="#条件表达式" class="headerlink" title="条件表达式"></a>条件表达式</h2><p>条件表达式用于在shell脚本中执行条件判断，常用的测试语句如下：</p>

        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2024-7-29-01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2024/07/28/2024-7-29-01/">shell脚本基础</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-07-28T16:00:00.000Z" itemprop="datePublished">2024-07-29</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Linux/">Linux</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            1.7k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h1><p>Shell 是一个命令行解释器，它为用户提供了一个向操作系统发送指令的接口。Shell 脚本（Shell Script）是一种为 Shell 编写的脚本程序，它包含了一系列的命令和语句，用于实现特定的功能。Shell 脚本通常用于自动化日常任务、批量处理文件、编写简单的应用程序等。<br>Shell脚本本质上是Shell命令的有序集合。</p>
<hr>
<h1 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注释</span></span><br><span class="line"><span class="comment"># 开头指定bash解释脚本,不写则默认shell</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 屏幕打印字符串：</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><h3 id="自定义变量"><a href="#自定义变量" class="headerlink" title="自定义变量"></a>自定义变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义变量</span></span><br><span class="line">name=<span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="comment"># 使用变量</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$name</span></span><br><span class="line"><span class="comment"># 只读变量</span></span><br><span class="line"><span class="built_in">readonly</span> name</span><br><span class="line"><span class="comment"># 删除变量</span></span><br><span class="line"><span class="built_in">unset</span> name</span><br></pre></td></tr></table></figure>

<h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><p>shell在开始运行时就已经定义了一些和系统工作环境有关的变量，我们在shell中可以直接使用<code>$name</code> 引用。<br>可以使用 <code>export</code> 前缀来自定义环境变量，或将已有变量修饰为环境变量。<br>另外，使用<code>env</code>命令可以查看当前系统所有的环境变量。环境变量使用unset也可以清除。<br>一般情况下环境变量是全大写字母</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义环境变量</span></span><br><span class="line"><span class="built_in">export</span> name=<span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="comment"># 使用环境变量</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$name</span></span><br></pre></td></tr></table></figure>

<h4 id="常见的环境变量"><a href="#常见的环境变量" class="headerlink" title="常见的环境变量"></a>常见的环境变量</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当前用户</span></span><br><span class="line">USER</span><br><span class="line"><span class="comment"># 当前用户家目录</span></span><br><span class="line">HOME</span><br><span class="line"><span class="comment"># 当前用户登录的终端</span></span><br><span class="line">SHELL</span><br><span class="line"><span class="comment"># 当前用户登录的终端类型</span></span><br><span class="line">TERM</span><br><span class="line"><span class="comment"># 当前用户登录的终端的编号</span></span><br><span class="line">Tty</span><br><span class="line"><span class="comment"># 当前用户登录的终端的进程号</span></span><br><span class="line">Pid</span><br><span class="line"><span class="comment"># 当前用户登录的终端的进程号</span></span><br></pre></td></tr></table></figure>

<h4 id="访问和编辑系统变量文件"><a href="#访问和编辑系统变量文件" class="headerlink" title="访问和编辑系统变量文件"></a>访问和编辑系统变量文件</h4><p>一般在 <code>~/.bashrc</code>或者<code>/etc/profile</code>文件中，可以编辑环境变量。<br><strong>编辑完成后，使用 <code>source ~/.bashrc</code> 或者 <code>source /etc/profile</code> 命令使修改生效。或者重启终端&#x2F;系统让其自动启用生效。</strong></p>
<h3 id="预设变量"><a href="#预设变量" class="headerlink" title="预设变量"></a>预设变量</h3><p>在运行shell脚本时，我们可以通过命令行参数的形式向脚本传递参数，这些参数在脚本中被称为预设变量。预设变量是shell脚本中预先定义好的变量，用于存储命令行参数的值。这样在shell脚本中就可以调用用户在执行脚本时传入的参数。</p>
<p><code>$0</code>：当前进程的名称</p>
<p><code>$$</code>：当前进程的进程号</p>
<p><code>$1 $2 $3 …… $9</code>：运行脚本时传递给其的参数。如果序号不止一位，必须使用花括号将序号连成整体<code>$&#123;10&#125;</code></p>
<p><code>$#</code>：参数个数</p>
<p><code>$*</code>：所有参数的内容(拼接字符串)</p>
<p><code>$@</code>：所有参数组成的数组(变量数组)</p>
<p><code>$?</code>：命令返回后的状态，0表示成功，非0表示失败</p>
<h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串拼接</span></span><br><span class="line">name=<span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;my name is <span class="variable">$&#123;name&#125;</span>&quot;</span></span><br><span class="line"><span class="comment"># 字符串长度</span></span><br><span class="line">name=<span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#name&#125;</span></span><br><span class="line"><span class="comment"># 字符串截取</span></span><br><span class="line">name=<span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;name:1:2&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义数组</span></span><br><span class="line">arr=(1 2 3)</span><br><span class="line"><span class="comment"># 使用数组</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;arr[0]&#125;</span></span><br><span class="line"><span class="comment"># 数组长度</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#arr[@]&#125;</span></span><br></pre></td></tr></table></figure>


<h2 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># if</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$1</span> -eq 1 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="variable">$1</span> -eq 2 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;2&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<h2 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># for</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 定义函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">func</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 调用函数</span></span><br><span class="line">func</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取文件</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$line</span></span><br><span class="line"><span class="keyword">done</span> &lt; file.txt</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="执行脚本的三种方式"><a href="#执行脚本的三种方式" class="headerlink" title="执行脚本的三种方式"></a>执行脚本的三种方式</h1><ol>
<li>chmod +x test.sh，后 .&#x2F;test.sh<br> 增加可执行权限后执行</li>
<li>bash test.sh<br> 直接指定bash解释运行脚本</li>
<li>. test.sh<br> <code>.</code>空格 + <code>脚本</code> 使用当前shell执行脚本，这种执行方式不会开启子进程，脚本中的变量会直接在当前shell中生效。而且会忽略脚本中指定的shell解释器类型。</li>
</ol>

        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2024-7-29-02" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2024/07/28/2024-7-29-02/">shell脚本变量的特殊用法</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-07-28T16:00:00.000Z" itemprop="datePublished">2024-07-29</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/Linux/">Linux</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            1k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h1 id="符号用法"><a href="#符号用法" class="headerlink" title="符号用法"></a>符号用法</h1><p><code>&quot;&quot;</code>：包含的变量会被解释，同时会识别解释其内的特殊字符。</p>
<p><code>&#39;&#39;</code>：包含的内容当作纯字符串原样输出，不会解释其内的特殊字符。例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&quot;zhangsan&quot;</span></span><br><span class="line">string1 = <span class="string">&quot;good morning <span class="variable">$name</span>&quot;</span></span><br><span class="line">string2 = <span class="string">&#x27;good morning $name&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$string1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$string2</span></span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">good morning zhangsan</span><br><span class="line">good morning <span class="variable">$name</span></span><br></pre></td></tr></table></figure>

<p><code>``</code> 或 <code>$()</code>：反引号(括号)中的内容作为系统命令，执行其内容，可以替换输出为一个变量，例如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$echo</span> <span class="string">&quot;todys is `date`&quot;</span></span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">todys is Mon Jul 29 14:15:00 CST 2024</span><br></pre></td></tr></table></figure>

<p><code>\</code>：转义符，除了可以像C语言中一样使用<code>\n</code> <code>\t</code> <code>\r</code>等转义字符为符号，将原来有特殊含义的字符变为普通字符，如<code>\$</code>等，如果要让<code>echo</code>指令识别转义符，则需要在<code>echo</code>命令前面加上<code>-e</code>提示符。</p>
<p><code>()</code>：括号，在括号中的命令会新开一个子shell顺序执行，括号外的命令在当前shell中执行，括号中如果出现变量，则变量作用域仅限于括号中，括号外无法使用括号内的变量。</p>
<p><code>&#123;&#125;</code>：大括号，大括号中的命令在当前shell顺序执行，大括号中可以使用当前shell的变量。<br><strong>注意<code>&#123;&#125;</code>内的命令因为是在当前的shell中执行，所以在回括前的最后一条语句也需要分号</strong><br>例如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">num = 100</span><br><span class="line"><span class="comment"># 在子shell中执行，不影响当前的变量</span></span><br><span class="line">( num = 999; <span class="built_in">echo</span> <span class="string">&quot;1.1: <span class="variable">$num</span>&quot;</span> )</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;1.2: <span class="variable">$num</span>&quot;</span>;</span><br><span class="line"><span class="comment"># 在当前shell执行，共用括号外部的变量</span></span><br><span class="line">&#123; num = 666; <span class="built_in">echo</span> <span class="string">&quot;2.1: <span class="variable">$num</span>&quot;</span>; &#125; <span class="comment"># 注意大括号在回括前的最后一条语句需要分号</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;2.2: <span class="variable">$num</span>&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.1: 999</span><br><span class="line">1.2: 100</span><br><span class="line">2.1: 666</span><br><span class="line">2.2: 666</span><br></pre></td></tr></table></figure>

<p><code>[]</code>：条件判断，在<code>[]</code>中的条件判断，条件前后必须有空格，例如：<code>[ $var -eq 1 ]</code>。</p>
<pre><code>
`$&#123;&#125;`：变量取值替换，在变量名前加上`$`符号，或者使用`$&#123;&#125;`符号，可以获取变量的值。例如：`echo $&#123;var&#125;` 或 `echo $var`。
</code></pre>

        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2024-7-21-01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2024/07/20/2024-7-21-01/">文件和文件指针的操作</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-07-20T16:00:00.000Z" itemprop="datePublished">2024-07-21</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            2.5k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" rel="tag">文件操作</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="文件指针"><a href="#文件指针" class="headerlink" title="文件指针"></a>文件指针</h2><p>文件指针就是用于标识一个文件的，程序中所有对文件的操作都需要通过文件指针执行。</p>
<h3 id="文件指针的一般形式"><a href="#文件指针的一般形式" class="headerlink" title="文件指针的一般形式"></a>文件指针的一般形式</h3><p>FILE* 指针变量标识符；</p>
<p>FILE为大写，需要引用&lt;stdio.h&gt;</p>
<p>FILE是系统使用typedef定义出来的有关文件信息的一种结构体类型，结构中含有文件名、文件状态和文件当前位置等信息</p>
<p>一般情况下，我们操作文件前必须定义一个文件指针标示我们将要操作的文件</p>
<p>实际编程中使用库函数操作文件，无需关心FILE结构体的细节，只需要将文件指针传给io库函数，库函数再通过FILE结构体里的信息对文件进行操作。</p>
<p>FILE 结构体的定义：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">short</span> level;            <span class="comment">//缓冲区“满”或“空”的程度</span></span><br><span class="line">    <span class="type">unsigned</span> flags;         <span class="comment">//文件状态标志</span></span><br><span class="line">    <span class="type">char</span> fd;                <span class="comment">//文件描述符</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> hold;     <span class="comment">//如无缓冲区不读取字符</span></span><br><span class="line">    <span class="type">short</span> bsize;            <span class="comment">//缓冲区的大小 </span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *buffer;  <span class="comment">//数据缓冲区的位置</span></span><br><span class="line">    <span class="type">unsigned</span> ar;            <span class="comment">//文件位置指示器</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> *curp;    <span class="comment">//文件位置指示器</span></span><br><span class="line">    <span class="type">unsigned</span> istemp;        <span class="comment">//临时文件指示器</span></span><br><span class="line">    <span class="type">short</span> token;            <span class="comment">//用于有效性检查</span></span><br><span class="line">&#125; FILE;</span><br></pre></td></tr></table></figure>

<p><strong>对文件操作的步骤：</strong></p>
<ol>
<li>对文件进行读写等操作之前要打开文件得到文件指针</li>
<li>可以通过文件指针对文件进行读写等操作</li>
<li>读写等操作完毕后，要关闭文件，关闭文件后，就不能再通过此文件指针操作文件了</li>
</ol>
<hr>
<h2 id="文件指针位置操作函数"><a href="#文件指针位置操作函数" class="headerlink" title="文件指针位置操作函数"></a>文件指针位置操作函数</h2><h3 id="ftell"><a href="#ftell" class="headerlink" title="ftell"></a>ftell</h3><p>获取文件指针的位置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="title function_">ftell</span><span class="params">(FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>ftell函数返回<code>stream</code>标识的文件指针的位置。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回文件指针的位置</li>
<li>失败：返回-1</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要获取的文件指针</li>
</ul>
<h3 id="fseek"><a href="#fseek" class="headerlink" title="fseek"></a>fseek</h3><p>设置文件指针的位置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fseek</span><span class="params">(</span></span><br><span class="line"><span class="params">  FILE *stream, </span></span><br><span class="line"><span class="params">  <span class="type">long</span> offset, </span></span><br><span class="line"><span class="params">  <span class="type">int</span> whence)</span>;</span><br></pre></td></tr></table></figure>

<p>fseek函数将<code>stream</code>标识的文件指针移动到<code>whence</code>指定的位置，移动的偏移量为<code>offset</code>。</p>
<p><strong>返回值：</strong></p>
<ul>
<li><p>成功：返回0</p>
</li>
<li><p>失败：返回非0</p>
</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要设置的文件指针</li>
<li>offset：要移动的偏移量<br><code>offset</code>的取值<ul>
<li>大于0：向文件末尾移动</li>
<li>小于0：向文件开头移动</li>
<li>等于0：不移动</li>
</ul>
</li>
<li>whence：要移动的位置<br><code>whence</code>的取值：<ul>
<li>SEEK_SET(0)：从文件开头开始移动</li>
<li>SEEK_CUR(1)：从文件当前位置开始移动</li>
<li>SEEK_END(2)：从文件末尾开始移动</li>
</ul>
</li>
</ul>
<p><strong>移动文件指针的结束条件：</strong></p>
<ul>
<li>移动到文件的末尾</li>
<li>移动到文件的<code>size-1</code>个字符</li>
<li>移动到文件结束符EOF</li>
</ul>
<h3 id="rewind"><a href="#rewind" class="headerlink" title="rewind"></a>rewind</h3><p>将文件指针重置到文件开头</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">rewind</span><span class="params">(FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>rewind函数将<code>stream</code>标识的文件指针重置到文件开头。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>无</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要重置的文件指针</li>
</ul>
<hr>
<h2 id="文件操作函数"><a href="#文件操作函数" class="headerlink" title="文件操作函数"></a>文件操作函数</h2><h3 id="fopen"><a href="#fopen" class="headerlink" title="fopen"></a>fopen</h3><p>打开文件并得到文件指针</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FILE *<span class="title function_">fopen</span><span class="params">(</span></span><br><span class="line"><span class="params">  <span class="type">const</span> <span class="type">char</span> *filename, </span></span><br><span class="line"><span class="params">  <span class="type">const</span> <span class="type">char</span> *mode)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>文件指针的初始化：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">fp = fopen(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (fp == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;文件打开失败\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回文件指针</li>
<li>失败：返回NULL</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>filename：要打开的文件路径</li>
<li>mode：打开文件的方式</li>
</ul>
<p><strong>文件打开路径(filename)：</strong></p>
<ul>
<li>绝对路径：从盘符开始的路径<code>C:/test/abc.txt</code></li>
<li>相对路径：从当前路径开始的路径<code>./abc.txt</code></li>
</ul>
<p><strong>文件打开方式(mode)：</strong></p>
<table>
<thead>
<tr>
<th align="center">模式</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">r</td>
<td align="center">只读，文件必须存在</td>
</tr>
<tr>
<td align="center">w</td>
<td align="center">只写，文件不存在则创建，存在则清空</td>
</tr>
<tr>
<td align="center">a</td>
<td align="center">只写，文件不存在则创建，存在则追加</td>
</tr>
<tr>
<td align="center">r+</td>
<td align="center">读写，文件必须存在</td>
</tr>
<tr>
<td align="center">w+</td>
<td align="center">读写，文件不存在则创建，存在则清空</td>
</tr>
<tr>
<td align="center">a+</td>
<td align="center">读写，文件不存在则创建，存在则追加</td>
</tr>
</tbody></table>
<p><strong>文件打开模式(mode)的补充：</strong></p>
<p><strong><code>+</code>的意义：</strong></p>
<ul>
<li>可以同时进行读写操作</li>
<li>文件指针在打开文件时默认指向文件开头，<code>r+</code>和<code>w+</code>会清空文件；<code>a+</code>不会清空文件，文件指针在打开文件时默认指向文件末尾。</li>
</ul>
<h3 id="fclose"><a href="#fclose" class="headerlink" title="fclose"></a>fclose</h3><p>关闭文件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fclose</span><span class="params">(FILE *fp)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回0</li>
<li>失败：返回EOF</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>fp：要关闭的文件指针</li>
</ul>
<p><strong>关闭文件的意义：</strong></p>
<ul>
<li>关闭文件后，文件指针将不再指向该文件，不能通过该文件指针对文件进行操作</li>
<li>关闭文件后，文件缓冲区中的数据会写入文件，文件指针指向文件末尾</li>
<li>关闭文件后，文件缓冲区会被释放，文件指针指向NULL</li>
</ul>
<p><strong>关闭文件的方式：</strong></p>
<ul>
<li>使用<code>fclose</code>函数关闭文件</li>
<li>程序结束时，操作系统会自动关闭所有打开的文件</li>
<li>程序结束时，如果文件没有被关闭，操作系统会自动关闭文件，但会输出警告信息</li>
</ul>
<p><strong>关闭文件的意义：</strong></p>
<ul>
<li>关闭文件后，文件指针将不再指向该文件，不能通过该文件指针对文件进行操作</li>
<li>关闭文件后，文件缓冲区中的数据会写入文件，文件指针指向文件末尾</li>
<li>关闭文件后，文件缓冲区会被释放，文件指针指向NULL</li>
</ul>
<h3 id="feof"><a href="#feof" class="headerlink" title="feof"></a>feof</h3><p>判断文件指针是否到达文件末尾</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">feof</span><span class="params">(FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>feof函数判断<code>stream</code>标识的文件指针是否到达文件末尾。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>到达文件末尾：返回非0</li>
<li>未到达文件末尾：返回0</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要判断的文件指针</li>
</ul>
<h3 id="ferror"><a href="#ferror" class="headerlink" title="ferror"></a>ferror</h3><p>判断文件操作是否出错</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">ferror</span><span class="params">(FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>ferror函数判断<code>stream</code>标识的文件操作是否出错。</p>
<p><strong>返回值：</strong></p>
<ul>
<li><p>出错：返回非0</p>
</li>
<li><p>未出错：返回0</p>
</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要判断的文件指针</li>
</ul>
<h3 id="clearerr"><a href="#clearerr" class="headerlink" title="clearerr"></a>clearerr</h3><p>清除文件指针的错误标志</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">clearerr</span><span class="params">(FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>clearerr函数清除<code>stream</code>标识的文件指针的错误标志。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>无</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要清除的文件指针</li>
</ul>
<h3 id="fflush"><a href="#fflush" class="headerlink" title="fflush"></a>fflush</h3><p>刷新文件缓冲区</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fflush</span><span class="params">(FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>fflush函数刷新<code>stream</code>标识的文件缓冲区。</p>
<p><strong>返回值：</strong></p>
<ul>
<li><p>成功：返回0</p>
</li>
<li><p>失败：返回EOF</p>
</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要刷新的文件指针</li>
</ul>

        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2024-7-25-01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2024/07/20/2024-7-25-01/">文件读写</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-07-20T16:00:00.000Z" itemprop="datePublished">2024-07-21</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            4.4k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" rel="tag">文件操作</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <h2 id="文件读写字符函数"><a href="#文件读写字符函数" class="headerlink" title="文件读写字符函数"></a>文件读写字符函数</h2><h3 id="fgetc"><a href="#fgetc" class="headerlink" title="fgetc"></a>fgetc</h3><p>从文件中读取一个字符</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fgetc</span><span class="params">(FILE *fp)</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">    fp = fopen(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;文件打开失败\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ch = fgetc(fp);</span><br><span class="line">    <span class="keyword">while</span> (ch != EOF)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, ch);<span class="comment">//打印字符</span></span><br><span class="line">        ch = fgetc(fp);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回读取到的字符</li>
<li>失败：返回EOF</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>fp：要读取的文件指针</li>
</ul>
<p><strong>读取字符的方式：</strong></p>
<ul>
<li>从文件指针的位置开始读取</li>
<li>每次读取一个字符</li>
<li>读取到的字符会自动转换为ASCII码</li>
</ul>
<p><strong>读取字符的结束条件：</strong></p>
<ul>
<li>读取到文件末尾</li>
<li>读取到文件结束符EOF</li>
</ul>
<h3 id="fgets"><a href="#fgets" class="headerlink" title="fgets"></a>fgets</h3><p>从文件中读取一行字符</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">fgets</span><span class="params">(<span class="type">char</span> *str, <span class="type">int</span> n, FILE *fp)</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">    fp = fopen(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;文件打开失败\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">while</span> (fgets(str, <span class="number">100</span>, fp) != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, str);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回读取到的字符串</li>
<li>失败：返回NULL</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>str：要读取的字符串</li>
<li>n：读取的字符数</li>
<li>fp：要读取的文件指针</li>
</ul>
<p><strong>读取字符串的方式：</strong></p>
<ul>
<li>从文件指针的位置开始读取</li>
<li>每次读取一行字符</li>
<li>读取到的字符会自动转换为ASCII码</li>
<li>读取完成后在输出的字符串末尾添加<code>\0</code></li>
</ul>
<p><strong>读取字符串的结束条件：</strong></p>
<ul>
<li>读取到文件的<code>换行符</code></li>
<li>读取到文件的<code>size-1</code>个字符</li>
<li>读取到文件结束符EOF</li>
</ul>
<h3 id="fputc"><a href="#fputc" class="headerlink" title="fputc"></a>fputc</h3><p>向文件中写入一个字符</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fputc</span><span class="params">(<span class="type">int</span> ch, FILE *fp)</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">    fp = fopen(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;文件打开失败\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ch = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span> (ch &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fputc(ch, fp);</span><br><span class="line">        ch++;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回写入的字符</li>
<li>失败：返回EOF</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>ch：要写入的字符</li>
<li>fp：要写入的文件指针</li>
</ul>
<p><strong>写入字符的方式：</strong></p>
<ul>
<li>从文件指针的位置开始写入</li>
<li>每次写入一个字符</li>
<li>写入的字符会自动转换为ASCII码</li>
</ul>
<h3 id="fputs"><a href="#fputs" class="headerlink" title="fputs"></a>fputs</h3><p>向文件中写入字符串</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fputs</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *str, FILE *fp)</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">    fp = fopen(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);<span class="comment">//以写入的方式打开文件</span></span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;文件打开失败\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">char</span> str[] = <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">    <span class="built_in">fputs</span>(str, fp);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回写入的字符串</li>
<li>失败：返回EOF</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>str：要写入的字符串</li>
<li>fp：要写入的文件指针</li>
</ul>
<p><strong>写入字符串的方式：</strong></p>
<ul>
<li>从文件指针的位置开始写入</li>
<li>写入的字符会自动转换为ASCII码</li>
</ul>
<p><strong>写入字符串的结束条件：</strong></p>
<ul>
<li>读取到字符串的末尾</li>
<li>读取到字符串的<code>换行符</code></li>
<li>读取到字符串的<code>\0</code></li>
</ul>
<hr>
<h2 id="文件读写函数"><a href="#文件读写函数" class="headerlink" title="文件读写函数"></a>文件读写函数</h2><h3 id="fread"><a href="#fread" class="headerlink" title="fread"></a>fread</h3><p>从文件中读取数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">fread</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="type">void</span> *ptr, </span></span><br><span class="line"><span class="params">    <span class="type">size_t</span> size, </span></span><br><span class="line"><span class="params">    <span class="type">size_t</span> nmemb, </span></span><br><span class="line"><span class="params">    FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>fread函数从<code>stream</code>标识的文件中读取数据，一元素的大小由<code>size</code>决定，共<code>nmemb</code>个元素，存放在<code>ptr</code>指定的内存中。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回<strong>实际读取到的</strong>元素个数</li>
<li>失败：返回0</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>ptr：要读取的数据的地址</li>
<li>size：每个元素的大小</li>
<li>nmemb：要读取的元素个数</li>
<li>stream：要读取的文件指针</li>
</ul>
<p><strong>读取数据的方式：</strong></p>
<ul>
<li>从文件指针的位置开始读取</li>
<li>每次读取一个元素</li>
<li>读取到的数据会自动转换为ASCII码</li>
</ul>
<h3 id="fwrite"><a href="#fwrite" class="headerlink" title="fwrite"></a>fwrite</h3><p>向文件中写入数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">size_t</span> <span class="title function_">fwrite</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="type">const</span> <span class="type">void</span> *ptr, </span></span><br><span class="line"><span class="params">    <span class="type">size_t</span> size, </span></span><br><span class="line"><span class="params">    <span class="type">size_t</span> nmemb, </span></span><br><span class="line"><span class="params">    FILE *stream)</span>;</span><br></pre></td></tr></table></figure>

<p>fwrite函数向<code>stream</code>标识的文件中写入数据，一元素的大小由<code>size</code>决定，共<code>nmemb</code>个元素，从<code>ptr</code>指定的内存中读取。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回<strong>实际写入的</strong>元素个数</li>
<li>失败：返回0</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>ptr：要写入的数据的地址</li>
<li>size：每个元素的大小</li>
<li>nmemb：要写入的元素个数</li>
<li>stream：要写入的文件指针</li>
</ul>
<p><strong>写入数据的方式：</strong></p>
<ul>
<li>从文件指针的位置开始写入</li>
<li>每次写入一个元素</li>
<li>写入的数据会自动转换为ASCII码</li>
</ul>
<p><strong>注意</strong></p>
<ul>
<li>fread&#x2F;fwrite函数读写数据时，会自动跳过文件中的空格、换行符等字符</li>
<li>fread&#x2F;fwrite函数可以将文件的内容解析为结构体等其他格式进行读写，而非字符类型的数据会以二进制格式保存在文件中<br>  例如：</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line">    <span class="type">char</span> c;</span><br><span class="line">&#125;MSG;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> * argc, <span class="type">char</span> * argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE * fp = fopen(<span class="string">&quot;./test.txt&quot;</span>, <span class="string">&quot;w+&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;error\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    MSG msg[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="string">&#x27;b&#x27;</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="string">&#x27;c&#x27;</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="string">&#x27;d&#x27;</span>&#125;;</span><br><span class="line">    fwrite(msg, <span class="keyword">sizeof</span>(MSG), <span class="number">4</span>, fp);<span class="comment">//先将结构体写入文件</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    rewind(fp); <span class="comment">//将文件指针重新定位到文件开头</span></span><br><span class="line">    MSG rcv[<span class="number">4</span>];</span><br><span class="line">    fread(rcv, <span class="keyword">sizeof</span>(MSG), <span class="number">4</span>, fp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d %c\n&quot;</span>, rcv[i].a, rcv[i].b, rcv[i].c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="fscanf"><a href="#fscanf" class="headerlink" title="fscanf"></a>fscanf</h3><p>从文件中读取格式化数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fscanf</span><span class="params">(</span></span><br><span class="line"><span class="params">    FILE *stream, </span></span><br><span class="line"><span class="params">    <span class="type">const</span> <span class="type">char</span> *format, </span></span><br><span class="line"><span class="params">    ...)</span>;</span><br></pre></td></tr></table></figure>

<p>fscanf函数从<code>stream</code>标识的文件中读取格式化数据，格式由<code>format</code>指定，参数由<code>...</code>指定。</p>
<p>用例：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> * argc, <span class="type">char</span> * argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE * fp = fopen(<span class="string">&quot;./test.txt&quot;</span>, <span class="string">&quot;w+&quot;</span>);</span><br><span class="line">    <span class="comment">//这里省略对fp的异常处理的代码段</span></span><br><span class="line">    <span class="built_in">fscanf</span>(fp, <span class="string">&quot;%d %d %d&quot;</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a = %d, b = %d, c = %d\n&quot;</span>, a, b, c);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 2 3</span><br></pre></td></tr></table></figure>

<p>输出结果：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回读取的参数个数</li>
<li>失败：返回EOF</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要读取的文件指针</li>
<li>format：要读取的格式化字符串</li>
<li>…：要读取的参数</li>
</ul>
<h3 id="fprintf"><a href="#fprintf" class="headerlink" title="fprintf"></a>fprintf</h3><p>向文件中写入格式化数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fprintf</span><span class="params">(</span></span><br><span class="line"><span class="params">    FILE *stream, </span></span><br><span class="line"><span class="params">    <span class="type">const</span> <span class="type">char</span> *format, </span></span><br><span class="line"><span class="params">    ...)</span>;</span><br></pre></td></tr></table></figure>

<p>fprintf函数向<code>stream</code>标识的文件中写入格式化数据，格式由<code>format</code>指定，参数由<code>...</code>指定。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回写入的字符个数</li>
<li>失败：返回EOF</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要写入的文件指针</li>
<li>format：要写入的格式化字符串</li>
<li>…：要写入的参数</li>
</ul>
<p><strong>写入数据的方式：</strong></p>
<ul>
<li>从文件指针的位置开始写入</li>
<li>每次写入一个字符</li>
<li>写入的数据会自动转换为ASCII码</li>
</ul>
<hr>
<hr>
<h2 id="文件的随机读写"><a href="#文件的随机读写" class="headerlink" title="文件的随机读写"></a>文件的随机读写</h2><p>在之前的<a href="https://zaiyuyou.github.io/2024/07/20/2024-7-21-01/">文件指针操作</a>中，介绍了对文件指针的读取位置进行操作和查询的函数，结合<a href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99%E5%87%BD%E6%95%B0">文件读写函数</a>就可以实现对文件内容的随机读写。<br>而除了<a href="https://zaiyuyou.github.io/2024/07/20/2024-7-21-01/">文件指针操作</a>中介绍的<code>ftell</code> <code>fseek</code> <code>rewind</code> 函数是对文件指针的<strong>位置偏移量</strong>进行操作</p>
<p>这里我们再介绍两个函数<code>fgetpos</code> <code>fsetpos</code>，这两个函数是<strong>直接操作</strong>文件指针的位置<br><strong>使用<code>fgetpos</code> <code>fsetpos</code>可以将文件中的特殊读写位置直接写入到<code>fpos_t</code>类型的变量中，在读写后快速将指针返回到变量储存的位置中，而不需要间接保存偏移量。这样可以确保在文件中进行非顺序操作时不会丢失数据。</strong></p>
<h3 id="fgetpos"><a href="#fgetpos" class="headerlink" title="fgetpos"></a>fgetpos</h3><p>获取文件指针当前位置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fgetpos</span><span class="params">(</span></span><br><span class="line"><span class="params">    FILE *stream, </span></span><br><span class="line"><span class="params">    <span class="type">fpos_t</span> *pos)</span>;</span><br></pre></td></tr></table></figure>

<p>fgetpos函数获取<code>stream</code>标识的文件指针当前位置，并保存在<code>pos</code>中。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回0</li>
<li>失败：返回非0</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要获取的文件指针</li>
<li>pos：保存文件指针当前位置的变量</li>
</ul>
<h3 id="fsetpos"><a href="#fsetpos" class="headerlink" title="fsetpos"></a>fsetpos</h3><p>将文件指针移动到指定位置</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fsetpos</span><span class="params">(</span></span><br><span class="line"><span class="params">    FILE *stream, </span></span><br><span class="line"><span class="params">    <span class="type">const</span> <span class="type">fpos_t</span> *pos)</span>;</span><br></pre></td></tr></table></figure>

<p>fsetpos函数将<code>stream</code>标识的文件指针移动到<code>pos</code>指定的位置。</p>
<p><strong>返回值：</strong></p>
<ul>
<li>成功：返回0</li>
<li>失败：返回非0</li>
</ul>
<p><strong>参数：</strong></p>
<ul>
<li>stream：要移动的文件指针</li>
<li>pos：要移动到的位置</li>
</ul>
<hr>

        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>







   


<article id="post-2024-7-19-01" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 itemprop="name">
        <a class="p-name article-title" href="/2024/07/18/2024-7-19-01/">位段</a>
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2024-07-18T16:00:00.000Z" itemprop="datePublished">2024-07-19</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
  <a class="meta-cate-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a>
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            1.7k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/" rel="tag">开发技巧</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p><em>阅读提示：本文使用了html相关控制语句设置单元格背景颜色，建议使用白色背景进行阅读(白天模式)</em></p>
<h1 id="位段"><a href="#位段" class="headerlink" title="位段"></a>位段</h1><p>C语言允许在一个结构体中以位为单位来指定其成员所占内存长度，这种以位为单位的成员称为“位段”或称“位段”(bit field)。<br>利用位段能够用较少的位数存储数据。。<code>unsigned int a:1</code>;表示a占1位Bit表示数字。<br>位段成员除了可以指定为<code>unsigned int</code>整形还可以指定为字符<code>char</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> a:<span class="number">1</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> b:<span class="number">1</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> c:<span class="number">2</span>;</span><br><span class="line">&#125;Bit;</span><br></pre></td></tr></table></figure>

<p>在底层编程中，使用位段可以很方便地将一个<a href="#%E5%AD%98%E5%82%A8%E5%8D%95%E5%85%83">存储单元</a>划分成若干长度不等的连续内存。但其内存分配与内存对齐的实现方式依赖于具体的机器和系统，<strong>在不同的平台可能有不同的结果，这导致了位段在本质上是不可移植的</strong>。不同的IDE在处理位段这种数据结构的时候确实会有很大的不同。比如vs和DEV-c++。<sup>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46359697/article/details/108293880">1</a>]</sup></p>
<h2 id="存储单元"><a href="#存储单元" class="headerlink" title="存储单元"></a>存储单元</h2><p>存储单元就是一个C语言的基本变量，如<code>int</code>、<code>char</code>等;<br><strong>位段必须存放在一个存储单元中，不能跨两个单元</strong>，一个单元空间不能容纳下一个位段，则该空间不用，而从下一个单元起存放该位段。’以下是常见的存储单元大小：</p>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">单元大小(Byte)</th>
<th align="center">最大长度(bit)</th>
</tr>
</thead>
<tbody><tr>
<td align="center">char</td>
<td align="center">1</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">short</td>
<td align="center">2</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">int</td>
<td align="center">4</td>
<td align="center">32</td>
</tr>
<tr>
<td align="center">long</td>
<td align="center">4</td>
<td align="center">32</td>
</tr>
<tr>
<td align="center">float</td>
<td align="center">4</td>
<td align="center">32</td>
</tr>
<tr>
<td align="center">double</td>
<td align="center">8</td>
<td align="center">64</td>
</tr>
</tbody></table>
<p><strong>测试代码：</strong> <strong><a target="_blank" rel="noopener" href="https://cpp.sh/?source=%23include%3Cstdio.h%3E%0D%0Astruct+temp1%7B%0D%0A++++char+a:7;%0D%0A++++char+b:7;%0D%0A++++char+c:2;%0D%0A%7Dtemp1;%0D%0A%0D%0Aint+main()%7B%0D%0A++++printf(%22%25d%5Cn%22,sizeof(temp1));%0D%0A++++return+0;%0D%0A%7D">[点击运行]</a></strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">temp1</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> a:<span class="number">7</span>;</span><br><span class="line">    <span class="type">char</span> b:<span class="number">7</span>;</span><br><span class="line">    <span class="type">char</span> c:<span class="number">2</span>;</span><br><span class="line">&#125;temp1;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="keyword">sizeof</span>(temp1));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>输出结果：</strong></p>
<figure class="highlight plaintext"><figcaption><span>output</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3</span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<p><code>char a:7</code>表示a占7位，<code>char b:7</code>表示b占7位，<code>char c:2</code>表示c占2位，一共是16位，但是一个存储单元是8位，<strong>且成员不能跨单位存储</strong>，所以需要三个存储单元，因此<code>sizeof(temp)</code>的结果是3。</p>
<table>
<capital>使用表格体现这个位段的内存划分：</capital>
<tr>
<th colspan=8 width="80px">存储单元1</th>
<th colspan=8 width="80px">存储单元2</th>
<th colspan=8 width="80px">存储单元3</th>
</tr>
<tr>
<th bgcolor=#ffffcc80>0</th>
<th bgcolor=#ffffcc80>1</th>
<th bgcolor=#ffffcc80>2</th>
<th bgcolor=#ffffcc80>3</th>
<th bgcolor=#ffffcc80>4</th>
<th bgcolor=#ffffcc80>5</th>
<th bgcolor=#ffffcc80>6</th>
<th>7</th>
<th bgcolor=#ffffcc80>0</th>
<th bgcolor=#ffffcc80>1</th>
<th bgcolor=#ffffcc80>2</th>
<th bgcolor=#ffffcc80>3</th>
<th bgcolor=#ffffcc80>4</th>
<th bgcolor=#ffffcc80>5</th>
<th bgcolor=#ffffcc80>6</th>
<th>7</th>
<th bgcolor=#ffffcc80>0</th>
<th bgcolor=#ffffcc80>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>


<tr>
<th colspan=7  bgcolor=#ffffcc80>a</th>
<th colspan=1>N</th>
<th colspan=7  bgcolor=#ffffcc80>b</th>
<th colspan=1>N</th>
<th colspan=2  bgcolor=#ffffcc80>c</th>
<th colspan=6>N</th>

</tr>
</table>


<h2 id="无名位段"><a href="#无名位段" class="headerlink" title="无名位段"></a>无名位段</h2><p>如果位段的定义没有给出标识符名字，那么这是无名位段，无法被初始化。<br>无名位段用于填充(padding)内存布局。<strong>只有无名位段的比特数可以为0</strong>。<br>这种占0比特的无名位段，用于强制让下一个位段在内存分配边界对齐。</p>
<p><strong>测试代码：</strong> <strong><a target="_blank" rel="noopener" href="https://cpp.sh/?source=%23include%3Cstdio.h%3E%0D%0Astruct+temp1%7B%0D%0A++++char+a:1;%0D%0A++++char+b:2;%0D%0A%7Dtemp1;%0D%0Astruct+temp2%7B%0D%0A++++char+a:1;%0D%0A++++char+:+0;%0D%0A++++char+b:2;%0D%0A%7Dtemp2;%0D%0A%0D%0Aint+main()%7B%0D%0A++++printf(%22temp1:%25d%5Cn%22,sizeof(temp1));%0D%0A++++printf(%22temp2:%25d%5Cn%22,sizeof(temp2));%0D%0A++++return+0;%0D%0A%7D">[点击运行]</a></strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">temp1</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> a:<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> b:<span class="number">2</span>;</span><br><span class="line">&#125;temp1;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">temp2</span>&#123;</span></span><br><span class="line">    <span class="type">char</span> a:<span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> b:<span class="number">2</span>;</span><br><span class="line">&#125;temp2;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;temp1:%d\n&quot;</span>,<span class="keyword">sizeof</span>(temp1));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;temp2:%d\n&quot;</span>,<span class="keyword">sizeof</span>(temp2));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>输出结果：</strong></p>
<figure class="highlight plaintext"><figcaption><span>output</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp1:1</span><br><span class="line">temp2:2</span><br></pre></td></tr></table></figure>

<p><strong>内存划分：</strong></p>
<table>
<capital>Temp1：</capital>
<tr>
<th colspan=8 width="80px">存储单元1</th>
</tr>
<tr>
<th bgcolor=#ffffcc80>0</th>
<th bgcolor=#ffaacc80>1</th>
<th bgcolor=#ffaacc80>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>

<tr>
<th colspan=1  bgcolor=#ffffcc80>a</th>
<th colspan=2  bgcolor=#ffaacc80>b</th>
<th colspan=5>N</th>

</tr>
</table>


<table>
<capital>Temp2：</capital>
<tr>
<th colspan=8 width="80px">存储单元1</th>
<th colspan=8 width="80px">存储单元2</th>
</tr>
<tr>
<th bgcolor=#ffffcc80>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th bgcolor=#ffaacc80>0</th>
<th bgcolor=#ffaacc80>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>

<tr>
<th colspan=1 bgcolor=#ffffcc80>a</th>
<th colspan=7>N</th>
<th colspan=2 bgcolor=#ffaacc80>b</th>
<th colspan=6>N</th>

</tr>
</table>

<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>通常在大端序系统(如PowerPC)，安排位域从最重要字节(most-significant byte)到最不重要字节(least-significant byte)，在一个字节内部从最重要位(most-significant bit)到最不重要位(least-significant bit)；</p>
<p>而在小端序系统(如x86)，安排位域从最不重要位(least-significant byte)到最重要字节(most-significant byte)，在一个字节内部从最不重要位(least-significant bit)到最重要位(most-significant bit)。</p>
<p>共同遵从的原则是内存字节地址从低到高，内存内部的比特编号从低到高。<sup>[<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46359697/article/details/108293880">1</a>]</sup></p>

        
      </div>

       
        <footer class="article-footer">
           
        </footer>
         
    </div>
    
     
  </div>
  
</article>








  <nav id="page-nav">
    <!-- 在第二页时 page.prev_link 不知为何无法返回正确的链接 -->
    <a id="prev-btn" class="page-nav-btn disabled" href=" /  ">
      <i class="fa-solid fa-angle-left"></i>
    </a>
    <div id="num-bar">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a>  
    </div>
    <a id="next-btn" class="page-nav-btn " href="/page/2/">
      <i class="fa-solid fa-angle-right"></i>
    </a>
  </nav>


    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2025 Zaiyuyou<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <i class="fa-solid fa-angle-up"></i>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
